{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"SchoolPay Pro \ud83c\udf93","text":"<p>The Ultimate Multi-tenant SaaS for School Fees Management.</p> <p>SchoolPay Pro is a production-ready, enterprise-grade Fintech solution for educational institutions. Built for the Nigerian market, it automates fee collection through Monnify virtual accounts and features a unique \"N200 Flat-Fee\" revenue model for the platform owner.</p>"},{"location":"#documentation","title":"\ud83d\udcda Documentation","text":"<ul> <li>User Guide: A complete walkthrough for School Admins &amp; Bursars.</li> <li>Technical Manual: Deep-dive into architecture, RLS, and Fintech logic.</li> <li>Deployment Guide: Steps to launch SchoolPay Pro in a production environment.</li> <li>Super-Admin Guide: Documentation for the SaaS platform owner.</li> </ul>"},{"location":"#enterprise-support-documents","title":"\ud83c\udfe2 Enterprise Support Documents","text":"<ul> <li>Security &amp; Compliance: RLS, data privacy, and fintech safety frameworks.</li> <li>API Reference: Documentation for edge functions and external integrations.</li> <li>Service Level Agreement (SLA): Uptime, support, and settlement commitments.</li> <li>Product Roadmap: Future features and planned platform expansions.</li> <li>Manual Test Guide: Task-based QA and testing instructions.</li> </ul>"},{"location":"#enterprise-features","title":"\u26a1 Enterprise Features","text":"<ul> <li>Multi-tenant SaaS Architecture: Host multiple schools on a single platform with strict logical isolation using PostgreSQL Row Level Security (RLS).</li> <li>Automated Fee Splitting (The \u20a6200 Rule): <ul> <li>Every transaction automatically deducts a flat \u20a6200 platform fee.</li> <li>Funds are instantly routed: Platform Owner (\u20a6200) vs School Subaccount (Remainder).</li> </ul> </li> <li>Fintech Ecosystem (Parent Wallet): <ul> <li>Parents fund an internal wallet via Monnify.</li> <li>Real-time settlement of fees, store items, and transport from wallet balances.</li> </ul> </li> <li>Smart Attendance &amp; Biometrics: <ul> <li>Geofencing: Staff must be within the school perimeter (GPS) to clock in.</li> <li>Facial Verification: Multi-step liveness check (Blink/Smile) using <code>react-webcam</code>.</li> <li>Offline Student Roll-call: Teachers can mark attendance without internet; data syncs automatically in the background.</li> </ul> </li> <li>Academic Intelligence Suite:<ul> <li>Grading &amp; Assessment: Bulk score uploads from Excel, automated rank calculation, and departmental analytics.</li> <li>Curriculum Repository: Centralized, version-controlled repository for Lesson Plans and Schemes of Work with administrative approval workflows.</li> <li>Computer Based Testing (CBT): Full quiz builder for teachers and timed exam mode for students.</li> </ul> </li> <li>Operational Efficiency:<ul> <li>Centralized Broadcast Center: Multi-channel (SMS/Email) announcements to parents, staff, or specific classes.</li> <li>Staff Appraisals: Formalized termly performance reviews and objective tracking.</li> <li>Automated ID Card Engine: One-click generation of professional PVC-format vertical ID cards for students and staff.</li> </ul> </li> <li>Super-Admin Control Center: A dedicated dashboard for the SaaS owner to monitor global revenue splits, school health, and platform-wide student data.</li> </ul>"},{"location":"#technology-stack","title":"\ud83d\udee0\ufe0f Technology Stack","text":"<ul> <li>Frontend: React 18 + Vite</li> <li>Styling: Tailwind CSS + shadcn/ui (Radix Primitives)</li> <li>Database Architecture: Supabase (PostgreSQL + Auth + Edge Functions)</li> <li>ORM: Drizzle ORM for migrations and type-safe auditing.</li> <li>Fintech Integration: Monnify API (Subaccounts, Reserved Accounts, Webhooks).</li> <li>State Management: TanStack Query v5.</li> </ul>"},{"location":"#getting-started","title":"\ud83d\ude80 Getting Started","text":""},{"location":"#prerequisites","title":"Prerequisites","text":"<ul> <li>Node.js (v20+ recommended)</li> <li>Supabase Account &amp; CLI</li> <li>Monnify API Keys (Merchant Code, API Key, Secret Key)</li> </ul>"},{"location":"#1-installation","title":"1. Installation","text":"<pre><code>git clone &lt;repository_url&gt;\ncd schoolpay-pro\nnpm install\n</code></pre>"},{"location":"#2-database-setup","title":"2. Database Setup","text":"<p>SchoolPay Pro uses Drizzle ORM to manage its high-integrity schema.</p> <pre><code># Push schema to Supabase\nnpm run db:push\n\n# Apply multi-tenant security policies (RLS)\nnpm run db:rls\n\n# Setup system triggers (Auto-profile creation)\nnpm run db:triggers\n</code></pre>"},{"location":"#3-environment-variables","title":"3. Environment Variables","text":"<p>Create a <code>.env</code> file:</p> <pre><code>VITE_SUPABASE_URL=your_project_url\nVITE_SUPABASE_ANON_KEY=your_anon_key\nDATABASE_URL=your_postgres_connection_string\n</code></pre>"},{"location":"#4-deploy-edge-functions","title":"4. Deploy Edge Functions","text":"<p>Deploy the logic for onboarding and payment processing.</p> <pre><code># Deploy all functions\nsupabase functions deploy onboard-school\nsupabase functions deploy generate-virtual-account\nsupabase functions deploy monnify-webhook\nsupabase functions deploy invite-user\nsupabase functions deploy promote-students\nsupabase functions deploy verify-payment\nsupabase functions deploy send-email\n\n# Set Fintech Secrets\nsupabase secrets set MONNIFY_API_KEY=... MONNIFY_SECRET_KEY=... PLATFORM_SUBACCOUNT_CODE=... RESEND_API_KEY=...\n</code></pre>"},{"location":"#roles-security","title":"\ud83d\udc6e Roles &amp; Security","text":"Role Permissions Super-Admin Global platform oversight, view total revenue (N200/tx), manage all schools. School Admin Manage their specific school settings, staff, students, and billing. Bursar View students, manage debt lists, and record manual payments."},{"location":"#enforcing-isolation","title":"Enforcing Isolation","text":"<p>We use logical isolation at the DB level. Every query is scoped via: <code>ALTER TABLE ... ENABLE ROW LEVEL SECURITY;</code> <code>CREATE POLICY ... USING (school_id = get_auth_school_id());</code></p>"},{"location":"#usage-guide","title":"\ud83d\udcd6 Usage Guide","text":"<ol> <li>Sign Up: Create an account via the standard login/signup page.</li> <li>Onboarding: After signup, you will be redirected to the Onboarding Page. Enter your school details and Settlement Bank Account.</li> <li>Wait for Provisioning: The system automatically creates your Monnify Subaccount.</li> <li>Enroll Students: Import your student list via CSV.</li> <li>Collect Fees: Click \"Generate Virtual Account\" for a student. Parents can then transfer funds directly to that account.</li> </ol>"},{"location":"#license","title":"\ud83d\udcc4 License","text":"<p>This project is licensed under the MIT License. Built with \u2764\ufe0f by Remitpro.</p>"},{"location":"contact/","title":"Contact Us","text":"<p>We are here to help you get the most out of SchoolPay Pro. Whether you are a school administrator, a parent, or a developer, feel free to reach out to us.</p>"},{"location":"contact/#email-us","title":"\ud83d\udce7 Email Us","text":"<p>For support, inquiries, or feedback, please email us at: info@remitpro.com.ng</p>"},{"location":"contact/#our-headquarters","title":"\ud83d\udccd Our Headquarters","text":"<p>Feel free to visit us or send official correspondence to: Suite 26, Jam Nab Plaza, Ladoke Akintola Blvd, Garki 2, Abuja</p>"},{"location":"contact/#website","title":"\ud83c\udf10 Website","text":"<p>Visit our official website for more information about our products and services: www.remitpro.com.ng</p> <p>SchoolPay Pro is a product of Remitpro.</p>"},{"location":"developer/api-reference/","title":"API Reference &amp; Integration Guide \ud83d\udd0c","text":"<p>SchoolPay Pro provides a suite of internal and external APIs (via Supabase Edge Functions) to power the multi-tenant ecosystem.</p>"},{"location":"developer/api-reference/#base-configuration","title":"\ud83c\udfd7\ufe0f Base Configuration","text":"<ul> <li>API URL: <code>https://[PROJECT_ID].supabase.co/functions/v1/</code></li> <li>Authentication: Bearer Token (User JWT) or Service Role Key for background processes.</li> </ul>"},{"location":"developer/api-reference/#endpoints","title":"\ud83d\udee0\ufe0f Endpoints","text":""},{"location":"developer/api-reference/#1-onboard-school","title":"1. <code>onboard-school</code>","text":"<p>Initializes a new school workspace and provisions financial sub-accounts.</p> <ul> <li>Method: <code>POST</code></li> <li>Payload:   <pre><code>{\n  \"name\": \"Academic Excellence School\",\n  \"email\": \"admin@school.com\",\n  \"phone\": \"+2348000000000\",\n  \"address\": \"123 Education Way, Lagos\",\n  \"bankName\": \"GTBank\",\n  \"accountNumber\": \"0123456789\",\n  \"accountName\": \"Academic Excellence Ltd\"\n}\n</code></pre></li> <li>Response: <code>200 OK</code> with <code>schoolId</code> and <code>subAccountCode</code>.</li> </ul>"},{"location":"developer/api-reference/#2-generate-virtual-account","title":"2. <code>generate-virtual-account</code>","text":"<p>Provisions a dedicated bank account for a specific student.</p> <ul> <li>Method: <code>POST</code></li> <li>Payload:   <pre><code>{\n  \"studentId\": \"uuid-of-student\",\n  \"schoolId\": \"uuid-of-school\"\n}\n</code></pre></li> <li>Response: Returns the account number and bank name assigned to the student.</li> </ul>"},{"location":"developer/api-reference/#3-invite-user","title":"3. <code>invite-user</code>","text":"<p>Triggers the RBAC onboarding workflow for staff.</p> <ul> <li>Method: <code>POST</code></li> <li>Payload:   <pre><code>{\n  \"email\": \"staff@school.com\",\n  \"role\": \"bursar\",\n  \"schoolId\": \"uuid\"\n}\n</code></pre></li> <li>Response: Sends invitation email and returns <code>200 OK</code>.</li> </ul>"},{"location":"developer/api-reference/#4-verify-payment","title":"4. <code>verify-payment</code>","text":"<p>Direct server-to-server verification of a transaction.</p> <ul> <li>Method: <code>POST</code></li> <li>Payload: { \"transactionReference\": \"REF-123\" }</li> <li>Logic: Considers both Monnify status and internal ledger consistency.</li> </ul>"},{"location":"developer/api-reference/#5-monnify-webhook","title":"5. <code>monnify-webhook</code>","text":"<p>Handles real-time payment notifications from Monnify.</p> <ul> <li>Method: <code>POST</code></li> <li>Headers: <code>monnify-signature</code> (HMAC-SHA512)</li> <li>Logic: Automatically updates <code>student_ledgers</code> and records <code>transactions</code> upon successful verification.</li> </ul>"},{"location":"developer/api-reference/#webhook-specification","title":"\ud83d\udce1 Webhook Specification","text":"<p>If you wish to integrate your own internal systems with SchoolPay Pro, you can subscribe to our event stream (via Supabase Realtime).</p>"},{"location":"developer/api-reference/#event-payment_success","title":"Event: <code>PAYMENT_SUCCESS</code>","text":"<p>Triggered when a student successfully pays their fees. <pre><code>{\n  \"event\": \"PAYMENT_SUCCESS\",\n  \"data\": {\n    \"student_id\": \"uuid\",\n    \"amount\": 55000.00,\n    \"transaction_ref\": \"SP-123456\",\n    \"paid_at\": \"2026-01-24T00:00:00Z\"\n  }\n}\n</code></pre></p>"},{"location":"developer/api-reference/#rate-limiting-quotas","title":"\ud83d\udd10 Rate Limiting &amp; Quotas","text":"<ul> <li>Standard Tier: 100 requests / minute per school.</li> <li>Enterprise Tier: Dedicated capacity with custom throughput.</li> </ul> <p>API v1.0 Documentation | \u00a9 2026 Remitpro Technologies</p>"},{"location":"developer/architecture/","title":"SchoolPay Pro - Technical Architecture Document","text":"<p>Version: 2.0.0 Last Updated: 2026-02-01 Status: Production-Ready</p>"},{"location":"developer/architecture/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Executive Summary</li> <li>Architectural Principles</li> <li>System Architecture</li> <li>Frontend Architecture</li> <li>Backend Architecture</li> <li>Data Architecture</li> <li>Security Architecture</li> <li>Integration Architecture</li> <li>Deployment Architecture</li> <li>Performance &amp; Scalability</li> <li>Monitoring &amp; Observability</li> <li>Future Considerations</li> </ol>"},{"location":"developer/architecture/#1-executive-summary","title":"1. Executive Summary","text":"<p>SchoolPay Pro is a multi-tenant SaaS platform designed for Nigerian educational institutions to manage finances, academics, HR, and operations. Built on a modern serverless-first architecture, the system leverages Supabase (PostgreSQL + Edge Functions), React (Vite), and Drizzle ORM to deliver a secure, scalable, and offline-capable solution.</p>"},{"location":"developer/architecture/#11-key-architectural-characteristics","title":"1.1 Key Architectural Characteristics","text":"Characteristic Implementation Multi-Tenancy Row-Level Security (RLS) with <code>school_id</code> isolation Security Model Zero-trust with client-side RLS + server-side validation Data Integrity Immutable financial logs, audit trails, ACID compliance Offline Support PWA with Service Workers + IndexedDB sync queue Scalability Serverless edge functions, connection pooling, indexed queries Compliance Nigerian financial regulations (WHT, Pension, TRCN)"},{"location":"developer/architecture/#12-technology-stack-overview","title":"1.2 Technology Stack Overview","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    CLIENT LAYER                              \u2502\n\u2502  React 18 + TypeScript 5 + Vite + Tailwind + Shadcn/UI     \u2502\n\u2502  React Query + React Router + PWA (Service Workers)         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                            \u2195 HTTPS/WSS\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   SUPABASE PLATFORM                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u2502\n\u2502  \u2502  PostgreSQL  \u2502  \u2502 Edge Functions\u2502  \u2502 Auth (GoTrue)\u2502      \u2502\n\u2502  \u2502  + RLS       \u2502  \u2502   (Deno)      \u2502  \u2502              \u2502      \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                         \u2502\n\u2502  \u2502   Storage    \u2502  \u2502  Realtime    \u2502                         \u2502\n\u2502  \u2502   (S3-like)  \u2502  \u2502  (WebSocket) \u2502                         \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                            \u2195 HTTPS\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              EXTERNAL INTEGRATIONS                           \u2502\n\u2502  Monnify (Payments) | Resend (Email) | Termii (SMS)        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"developer/architecture/#2-architectural-principles","title":"2. Architectural Principles","text":"<p>The system is built on the following core principles:</p>"},{"location":"developer/architecture/#21-design-principles","title":"2.1 Design Principles","text":"<ol> <li>Security by Default: All data access controlled by RLS; sensitive operations in Edge Functions</li> <li>Offline-First: Critical workflows (attendance) function without internet connectivity</li> <li>Financial Integrity: Immutable transaction logs; double-entry accounting principles</li> <li>Type Safety: End-to-end TypeScript with Zod runtime validation</li> <li>Multi-Tenant Isolation: Strict data segregation at database level</li> <li>Auditability: Comprehensive logging of all state-changing operations</li> <li>Progressive Enhancement: Core features work on basic browsers; enhanced on modern ones</li> </ol>"},{"location":"developer/architecture/#22-architectural-patterns","title":"2.2 Architectural Patterns","text":"<ul> <li>Client-First Architecture: Direct database access from frontend (secured by RLS)</li> <li>CQRS-Lite: Separate read/write paths for complex financial operations</li> <li>Event-Driven: Webhooks and database triggers for async workflows</li> <li>Service Layer Pattern: Business logic encapsulated in TypeScript services</li> <li>Repository Pattern: Drizzle ORM abstracts database operations</li> </ul>"},{"location":"developer/architecture/#3-system-architecture","title":"3. System Architecture","text":""},{"location":"developer/architecture/#31-high-level-system-context","title":"3.1 High-Level System Context","text":"<pre><code>C4Context\n    title System Context - SchoolPay Pro\n\n    Person(admin, \"School Admin\", \"Manages school operations\")\n    Person(teacher, \"Teacher\", \"Records grades, attendance\")\n    Person(parent, \"Parent\", \"Pays fees, views reports\")\n    Person(superadmin, \"Platform Owner\", \"Monitors all schools\")\n\n    System(schoolpay, \"SchoolPay Pro\", \"Multi-tenant school management platform\")\n\n    System_Ext(monnify, \"Monnify\", \"Payment gateway\")\n    System_Ext(resend, \"Resend\", \"Email delivery\")\n    System_Ext(termii, \"Termii\", \"SMS gateway\")\n\n    Rel(admin, schoolpay, \"Manages via web\")\n    Rel(teacher, schoolpay, \"Records data via mobile/web\")\n    Rel(parent, schoolpay, \"Pays fees, views reports\")\n    Rel(superadmin, schoolpay, \"Monitors platform\")\n\n    Rel(schoolpay, monnify, \"Processes payments\")\n    Rel(schoolpay, resend, \"Sends emails\")\n    Rel(schoolpay, termii, \"Sends SMS\")\n    Rel(monnify, schoolpay, \"Webhook notifications\")\n</code></pre>"},{"location":"developer/architecture/#32-container-diagram","title":"3.2 Container Diagram","text":"<pre><code>graph TB\n    subgraph \"Client Layer\"\n        SPA[React SPA&lt;br/&gt;Vite + TypeScript]\n        SW[Service Worker&lt;br/&gt;PWA Cache]\n    end\n\n    subgraph \"Supabase Platform\"\n        API[PostgREST API&lt;br/&gt;Auto-generated]\n        Auth[GoTrue Auth&lt;br/&gt;JWT-based]\n        DB[(PostgreSQL&lt;br/&gt;with RLS)]\n        Storage[Object Storage&lt;br/&gt;S3-compatible]\n        Realtime[Realtime Server&lt;br/&gt;WebSocket]\n\n        subgraph \"Edge Functions (Deno)\"\n            EF1[onboard-school]\n            EF2[monnify-webhook]\n            EF3[verify-payment]\n            EF4[invite-user]\n            EF5[promote-students]\n        end\n    end\n\n    subgraph \"External Services\"\n        Monnify[Monnify API]\n        Resend[Resend API]\n        Termii[Termii API]\n    end\n\n    SPA --&gt;|REST/GraphQL| API\n    SPA --&gt;|Auth| Auth\n    SPA --&gt;|Invoke| EF1\n    SPA --&gt;|Upload| Storage\n    SPA --&gt;|Subscribe| Realtime\n\n    API --&gt; DB\n    Auth --&gt; DB\n    EF1 --&gt; DB\n    EF2 --&gt; DB\n    EF3 --&gt; DB\n\n    EF1 --&gt;|Create Subaccount| Monnify\n    EF2 --&gt;|Verify Signature| Monnify\n    EF4 --&gt;|Send Invite| Resend\n    Monnify --&gt;|Payment Webhook| EF2\n</code></pre>"},{"location":"developer/architecture/#33-data-flow-patterns","title":"3.3 Data Flow Patterns","text":""},{"location":"developer/architecture/#331-payment-processing-flow","title":"3.3.1 Payment Processing Flow","text":"<pre><code>sequenceDiagram\n    participant Parent\n    participant Frontend\n    participant Monnify\n    participant Webhook as monnify-webhook\n    participant DB as PostgreSQL\n    participant Notification\n\n    Parent-&gt;&gt;Frontend: Initiate Payment\n    Frontend-&gt;&gt;Monnify: Open Payment Widget\n    Monnify-&gt;&gt;Parent: Display Payment Options\n    Parent-&gt;&gt;Monnify: Complete Payment\n\n    Monnify-&gt;&gt;Webhook: POST /monnify-webhook\n    Webhook-&gt;&gt;Webhook: Validate Signature\n    Webhook-&gt;&gt;DB: BEGIN TRANSACTION\n    Webhook-&gt;&gt;DB: UPDATE student_ledgers\n    Webhook-&gt;&gt;DB: INSERT transactions\n    Webhook-&gt;&gt;DB: UPDATE students.outstandingBalance\n    Webhook-&gt;&gt;DB: COMMIT\n\n    Webhook-&gt;&gt;Notification: Queue Receipt Email\n    Webhook-&gt;&gt;Frontend: Return Success\n    Frontend-&gt;&gt;Parent: Show Confirmation\n</code></pre>"},{"location":"developer/architecture/#332-offline-attendance-sync-flow","title":"3.3.2 Offline Attendance Sync Flow","text":"<pre><code>sequenceDiagram\n    participant Teacher\n    participant Frontend\n    participant LocalDB as IndexedDB\n    participant ServiceWorker\n    participant Supabase\n    participant DB\n\n    Teacher-&gt;&gt;Frontend: Mark Attendance (Offline)\n    Frontend-&gt;&gt;LocalDB: Store in Queue\n    Frontend-&gt;&gt;Teacher: Show Pending Status\n\n    Note over Frontend: Network Restored\n\n    Frontend-&gt;&gt;Frontend: Detect Online Event\n    Frontend-&gt;&gt;LocalDB: Fetch Pending Records\n    Frontend-&gt;&gt;Supabase: Batch Upsert\n    Supabase-&gt;&gt;DB: INSERT attendance records\n    DB-&gt;&gt;Supabase: Confirm\n    Supabase-&gt;&gt;Frontend: Success\n    Frontend-&gt;&gt;LocalDB: Clear Queue\n    Frontend-&gt;&gt;Teacher: Sync Complete\n</code></pre>"},{"location":"developer/architecture/#4-frontend-architecture","title":"4. Frontend Architecture","text":""},{"location":"developer/architecture/#41-component-architecture","title":"4.1 Component Architecture","text":"<pre><code>src/\n\u251c\u2500\u2500 components/\n\u2502   \u251c\u2500\u2500 ui/              # Shadcn primitives (Button, Dialog, etc.)\n\u2502   \u251c\u2500\u2500 layout/          # Layout components (Sidebar, Header)\n\u2502   \u251c\u2500\u2500 dashboard/       # Dashboard-specific widgets\n\u2502   \u2514\u2500\u2500 forms/           # Reusable form components\n\u251c\u2500\u2500 pages/\n\u2502   \u251c\u2500\u2500 Dashboard.tsx\n\u2502   \u251c\u2500\u2500 Students.tsx\n\u2502   \u251c\u2500\u2500 Finance.tsx\n\u2502   \u2514\u2500\u2500 [34 total pages]\n\u251c\u2500\u2500 services/\n\u2502   \u251c\u2500\u2500 AcademicService.ts\n\u2502   \u251c\u2500\u2500 FeeService.ts\n\u2502   \u251c\u2500\u2500 PayrollService.ts\n\u2502   \u2514\u2500\u2500 [15 total services]\n\u251c\u2500\u2500 hooks/\n\u2502   \u251c\u2500\u2500 useAuth.ts\n\u2502   \u251c\u2500\u2500 useSchoolSettings.ts\n\u2502   \u2514\u2500\u2500 useOfflineSync.ts\n\u251c\u2500\u2500 lib/\n\u2502   \u251c\u2500\u2500 supabase.ts      # Supabase client\n\u2502   \u251c\u2500\u2500 utils.ts         # Helper functions\n\u2502   \u2514\u2500\u2500 constants.ts\n\u2514\u2500\u2500 App.tsx              # Root component with routing\n</code></pre>"},{"location":"developer/architecture/#42-state-management-strategy","title":"4.2 State Management Strategy","text":"State Type Solution Use Case Server State React Query API data, caching, optimistic updates Auth State Supabase Auth + Context User session, permissions UI State React Context Theme, sidebar state, modals Form State React Hook Form + Zod Form validation, submission Offline Queue IndexedDB + Custom Hook Attendance, offline operations"},{"location":"developer/architecture/#43-pwa-configuration","title":"4.3 PWA Configuration","text":"<pre><code>// vite.config.ts - PWA Setup\nVitePWA({\n  registerType: 'autoUpdate',\n  workbox: {\n    navigateFallbackDenylist: [/^\\/supabase\\//],\n    runtimeCaching: [\n      {\n        urlPattern: ({ url }) =&gt; url.origin === 'https://monnify.com',\n        handler: 'NetworkOnly', // Never cache payment pages\n      }\n    ]\n  }\n})\n</code></pre> <p>Offline Capabilities: - \u2705 Static assets cached (HTML, CSS, JS, images) - \u2705 Attendance marking works offline - \u2705 Read-only data viewing (cached queries) - \u274c Payments require internet (security) - \u274c Real-time features disabled offline</p>"},{"location":"developer/architecture/#44-routing-architecture","title":"4.4 Routing Architecture","text":"<pre><code>// App.tsx - Route Structure\n&lt;Routes&gt;\n  &lt;Route path=\"/\" element={&lt;Landing /&gt;} /&gt;\n  &lt;Route path=\"/login\" element={&lt;Login /&gt;} /&gt;\n\n  {/* Protected Routes */}\n  &lt;Route element={&lt;ProtectedRoute /&gt;}&gt;\n    &lt;Route path=\"/dashboard\" element={&lt;Dashboard /&gt;} /&gt;\n    &lt;Route path=\"/students\" element={&lt;Students /&gt;} /&gt;\n    &lt;Route path=\"/finance/*\" element={&lt;FinanceRoutes /&gt;} /&gt;\n    &lt;Route path=\"/academics/*\" element={&lt;AcademicsRoutes /&gt;} /&gt;\n    &lt;Route path=\"/hr/*\" element={&lt;HRRoutes /&gt;} /&gt;\n  &lt;/Route&gt;\n\n  {/* Super Admin Routes */}\n  &lt;Route element={&lt;SuperAdminRoute /&gt;}&gt;\n    &lt;Route path=\"/super-admin/*\" element={&lt;SuperAdminRoutes /&gt;} /&gt;\n  &lt;/Route&gt;\n&lt;/Routes&gt;\n</code></pre>"},{"location":"developer/architecture/#5-backend-architecture","title":"5. Backend Architecture","text":""},{"location":"developer/architecture/#51-edge-functions-architecture","title":"5.1 Edge Functions Architecture","text":"<p>All Edge Functions run on Deno runtime with TypeScript support.</p>"},{"location":"developer/architecture/#function-inventory","title":"Function Inventory","text":"Function HTTP Method Authentication Purpose <code>onboard-school</code> POST Service Role Create school + Monnify subaccount <code>invite-user</code> POST User JWT Send staff invitation email <code>generate-virtual-account</code> POST User JWT Create student virtual account <code>monnify-webhook</code> POST Webhook Signature Process payment notifications <code>webhook-payment</code> POST Webhook Signature Alternative payment webhook <code>verify-payment</code> POST User JWT Manual payment verification <code>promote-students</code> POST Admin JWT Batch class promotion <code>send-email</code> POST Service Role Email proxy (hides API keys) <code>send-sms</code> POST Service Role SMS proxy (hides API keys) <code>monnify-create-account</code> POST Service Role Standalone account creation"},{"location":"developer/architecture/#example-payment-webhook-security","title":"Example: Payment Webhook Security","text":"<pre><code>// supabase/functions/monnify-webhook/index.ts\nimport { createHmac } from 'crypto';\n\nDeno.serve(async (req) =&gt; {\n  const payload = await req.json();\n  const signature = req.headers.get('monnify-signature');\n\n  // Verify webhook authenticity\n  const computedSignature = createHmac('sha512', MONNIFY_SECRET)\n    .update(JSON.stringify(payload))\n    .digest('hex');\n\n  if (signature !== computedSignature) {\n    return new Response('Invalid signature', { status: 401 });\n  }\n\n  // Process payment...\n  await supabase.from('transactions').insert({\n    studentId: payload.productCode,\n    amount: payload.amountPaid,\n    transactionReference: payload.transactionReference,\n    // ... immutable record\n  });\n\n  return new Response('OK', { status: 200 });\n});\n</code></pre>"},{"location":"developer/architecture/#52-service-layer-pattern","title":"5.2 Service Layer Pattern","text":"<p>Business logic is encapsulated in 15 TypeScript services:</p> <pre><code>// Example: FeeService.ts\nexport class FeeService {\n  static async generateLedgerEntries(\n    studentId: string,\n    classLevel: string,\n    term: string\n  ): Promise&lt;void&gt; {\n    // 1. Fetch master fee schedule for class\n    const schedule = await supabase\n      .from('master_fee_schedule')\n      .select('*')\n      .eq('class_level', classLevel);\n\n    // 2. Create ledger entries for student\n    const entries = schedule.data.map(fee =&gt; ({\n      student_id: studentId,\n      fee_schedule_id: fee.id,\n      fee_name: fee.name,\n      amount: fee.amount,\n      term: term,\n      is_paid: false\n    }));\n\n    await supabase.from('student_ledgers').insert(entries);\n\n    // 3. Audit log\n    await AuditService.log('fee_generation', 'student', studentId);\n  }\n}\n</code></pre> <p>Service Responsibilities: - AcademicService: Grade calculations, report cards, class positions - FeeService: Ledger generation, payment allocation - PayrollService: Salary calculations, deductions (pension, WHT) - NotificationService: Multi-channel messaging (Email, SMS, In-App) - WalletService: Parent wallet management, balance tracking - AuditService: Compliance logging</p>"},{"location":"developer/architecture/#6-data-architecture","title":"6. Data Architecture","text":""},{"location":"developer/architecture/#61-database-schema-overview","title":"6.1 Database Schema Overview","text":"<p>Total Tables: 30+ Schema Management: Drizzle ORM (<code>src/db/schema.ts</code>) Migration Tool: <code>drizzle-kit</code></p>"},{"location":"developer/architecture/#core-domain-models","title":"Core Domain Models","text":"<pre><code>erDiagram\n    SCHOOLS ||--o{ STUDENTS : contains\n    SCHOOLS ||--o{ PROFILES : employs\n    SCHOOLS ||--o{ MASTER_FEE_SCHEDULE : defines\n\n    STUDENTS ||--o{ STUDENT_LEDGERS : owes\n    STUDENTS ||--o{ TRANSACTIONS : pays\n    STUDENTS ||--o{ ACADEMIC_RECORDS : achieves\n\n    MASTER_FEE_SCHEDULE ||--o{ STUDENT_LEDGERS : generates\n\n    PROFILES ||--o{ AUDIT_LOGS : performs\n\n    SCHOOLS {\n        uuid id PK\n        text name\n        text monnify_subaccount_code\n        text current_session\n        text current_term\n        numeric geofence_lat\n        numeric geofence_lng\n    }\n\n    STUDENTS {\n        uuid id PK\n        uuid school_id FK\n        text student_id UK\n        text class\n        numeric outstanding_balance\n        text virtual_account_number UK\n    }\n\n    STUDENT_LEDGERS {\n        uuid id PK\n        uuid student_id FK\n        uuid fee_schedule_id FK\n        numeric amount\n        numeric amount_settled\n        boolean is_paid\n        text term\n    }\n\n    TRANSACTIONS {\n        uuid id PK\n        uuid student_id FK\n        numeric amount\n        text transaction_reference UK\n        numeric balance_before\n        numeric balance_after\n        numeric platform_fee\n    }\n</code></pre>"},{"location":"developer/architecture/#62-financial-data-model","title":"6.2 Financial Data Model","text":"<p>The financial system uses a modified double-entry approach:</p> <pre><code>Master Fee Schedule (Template)\n        \u2193\nStudent Ledgers (Debt Tracker)\n        \u2193\nTransactions (Immutable Payment Log)\n</code></pre> <p>Key Principles: 1. Master Fee Schedule: Single source of truth for fees per class 2. Student Ledgers: Individual debt records (mutable: <code>amount_settled</code>) 3. Transactions: Immutable payment history (never deleted/updated) 4. Balance Calculation: <code>outstanding_balance = SUM(ledger.amount - ledger.amount_settled)</code></p>"},{"location":"developer/architecture/#63-indexing-strategy","title":"6.3 Indexing Strategy","text":"<pre><code>-- High-traffic query optimization\nCREATE INDEX ledger_school_idx ON student_ledgers(school_id);\nCREATE INDEX ledger_student_idx ON student_ledgers(student_id);\nCREATE INDEX ledger_unpaid_idx ON student_ledgers(school_id, is_paid);\nCREATE INDEX transactions_created_idx ON transactions(created_at);\nCREATE INDEX students_created_idx ON students(created_at);\n\n-- Unique constraints for data integrity\nCREATE UNIQUE INDEX school_id_student_id_idx ON students(school_id, student_id);\nCREATE UNIQUE INDEX student_position_idx ON class_positions(student_id, session, term);\n</code></pre>"},{"location":"developer/architecture/#64-data-retention-archival","title":"6.4 Data Retention &amp; Archival","text":"Data Type Retention Archive Strategy Transactions Permanent Never delete (compliance) Audit Logs 7 years Move to cold storage after 2 years Academic Records Permanent Archived per session Attendance 5 years Aggregate to monthly summaries Notifications 90 days Delete after read + 90 days"},{"location":"developer/architecture/#7-security-architecture","title":"7. Security Architecture","text":""},{"location":"developer/architecture/#71-multi-tenant-isolation-rls","title":"7.1 Multi-Tenant Isolation (RLS)","text":"<p>Row-Level Security is the cornerstone of data isolation:</p> <pre><code>-- Example RLS Policy for students table\nCREATE POLICY \"school_isolation_policy\" ON students\n  USING (school_id = (\n    SELECT school_id FROM profiles WHERE id = auth.uid()\n  ));\n\n-- Super-admin bypass\nCREATE POLICY \"super_admin_access\" ON students\n  USING (\n    EXISTS (\n      SELECT 1 FROM profiles \n      WHERE id = auth.uid() \n      AND role = 'super_admin'\n    )\n  );\n</code></pre> <p>RLS Coverage: - \u2705 All tables with <code>school_id</code> have isolation policies - \u2705 <code>profiles</code> table links <code>auth.uid()</code> to <code>school_id</code> - \u2705 Super-admin role can bypass for platform monitoring - \u2705 Policies enforced at PostgreSQL level (not application)</p>"},{"location":"developer/architecture/#72-authentication-authorization","title":"7.2 Authentication &amp; Authorization","text":"<pre><code>graph LR\n    A[User Login] --&gt; B{Supabase Auth}\n    B --&gt;|Success| C[JWT Token]\n    C --&gt; D[Frontend Stores Token]\n    D --&gt; E[API Requests Include Token]\n    E --&gt; F{RLS Check}\n    F --&gt;|Authorized| G[Return Data]\n    F --&gt;|Denied| H[403 Forbidden]\n</code></pre> <p>Auth Flow: 1. User authenticates via Supabase Auth (email/password) 2. JWT token issued (contains <code>user_id</code>) 3. Token included in all API requests 4. PostgreSQL RLS uses <code>auth.uid()</code> from JWT 5. Data filtered by <code>school_id</code> automatically</p> <p>Role-Based Access Control (RBAC):</p> Role Permissions Implementation <code>super_admin</code> Platform-wide access RLS bypass policy <code>admin</code> Full school access Standard RLS <code>teacher</code> Read students, write grades Application-level checks <code>accountant</code> Finance module only Application-level checks <code>parent</code> View own children only Custom RLS on student_id"},{"location":"developer/architecture/#73-payment-security","title":"7.3 Payment Security","text":"<p>Monnify Integration Security: 1. Webhook Signature Validation: HMAC-SHA512 verification 2. Idempotency: <code>transaction_reference</code> unique constraint prevents duplicates 3. Split Settlement: Platform fee deducted at gateway level 4. PCI Compliance: No card data stored (Monnify handles)</p> <p>Virtual Account Security: - Accounts generated server-side only (<code>generate-virtual-account</code> edge function) - Account numbers permanently linked to <code>student_id</code> - Cannot be reassigned or deleted</p>"},{"location":"developer/architecture/#74-data-protection","title":"7.4 Data Protection","text":"Layer Protection Mechanism Transport TLS 1.3 (HTTPS) Storage PostgreSQL encryption at rest Secrets Environment variables (never committed) API Keys Hidden in Edge Functions (not exposed to client) Sensitive Fields NIN, TIN encrypted in database Audit Trail All mutations logged to <code>audit_logs</code>"},{"location":"developer/architecture/#8-integration-architecture","title":"8. Integration Architecture","text":""},{"location":"developer/architecture/#81-monnify-payment-gateway","title":"8.1 Monnify Payment Gateway","text":"<p>Integration Type: REST API + Webhook Authentication: API Key + Secret Environment: Production</p>"},{"location":"developer/architecture/#payment-flow-architecture","title":"Payment Flow Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Parent    \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6\u2502   Frontend   \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6\u2502  Monnify    \u2502\n\u2502             \u2502         \u2502  (Widget)    \u2502         \u2502   Widget    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                                         \u2502\n                                                         \u25bc\n                                                  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                                                  \u2502   Payment   \u2502\n                                                  \u2502  Processor  \u2502\n                                                  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                                         \u2502\n                        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                        \u25bc\n                 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                 \u2502   Webhook   \u2502\n                 \u2502  (Async)    \u2502\n                 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                        \u2502\n                        \u25bc\n              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n              \u2502 monnify-webhook  \u2502\n              \u2502  Edge Function   \u2502\n              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                        \u2502\n                        \u25bc\n                \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                \u2502  PostgreSQL  \u2502\n                \u2502  (Update)    \u2502\n                \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Revenue Model: - Platform Fee: \u20a6200 per transaction (fixed) - Implementation: Split settlement at Monnify level - Settlement: Automatic to school subaccount + platform account</p>"},{"location":"developer/architecture/#82-communication-services","title":"8.2 Communication Services","text":""},{"location":"developer/architecture/#resend-email","title":"Resend (Email)","text":"<pre><code>// Edge Function: send-email\nawait fetch('https://api.resend.com/emails', {\n  method: 'POST',\n  headers: {\n    'Authorization': `Bearer ${RESEND_API_KEY}`,\n    'Content-Type': 'application/json'\n  },\n  body: JSON.stringify({\n    from: 'noreply@schoolpay.com.ng',\n    to: recipient,\n    subject: subject,\n    html: htmlContent\n  })\n});\n</code></pre> <p>Use Cases: - Payment receipts - Staff invitations - Report card notifications - Password resets</p>"},{"location":"developer/architecture/#termii-sms","title":"Termii (SMS)","text":"<pre><code>// Edge Function: send-sms\nawait fetch('https://api.ng.termii.com/api/sms/send', {\n  method: 'POST',\n  headers: { 'Content-Type': 'application/json' },\n  body: JSON.stringify({\n    api_key: TERMII_API_KEY,\n    to: phoneNumber,\n    from: 'SchoolPay',\n    sms: message,\n    type: 'plain',\n    channel: 'generic'\n  })\n});\n</code></pre> <p>Use Cases: - Payment confirmations - Fee reminders - Emergency alerts</p>"},{"location":"developer/architecture/#83-integration-resilience","title":"8.3 Integration Resilience","text":"<p>Retry Strategy: <pre><code>async function retryWithBackoff(fn, maxRetries = 3) {\n  for (let i = 0; i &lt; maxRetries; i++) {\n    try {\n      return await fn();\n    } catch (error) {\n      if (i === maxRetries - 1) throw error;\n      await new Promise(resolve =&gt; \n        setTimeout(resolve, Math.pow(2, i) * 1000)\n      );\n    }\n  }\n}\n</code></pre></p> <p>Circuit Breaker: Implemented for external APIs to prevent cascade failures</p>"},{"location":"developer/architecture/#9-deployment-architecture","title":"9. Deployment Architecture","text":""},{"location":"developer/architecture/#91-infrastructure-overview","title":"9.1 Infrastructure Overview","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    Vercel Edge Network                    \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502  Static Assets (CDN)                               \u2502  \u2502\n\u2502  \u2502  - HTML, CSS, JS (Gzipped)                        \u2502  \u2502\n\u2502  \u2502  - Images, Fonts                                   \u2502  \u2502\n\u2502  \u2502  - Service Worker                                  \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502  SPA Routing (vercel.json)                        \u2502  \u2502\n\u2502  \u2502  - Fallback to index.html                         \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                            \u2195\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   Supabase Cloud                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u2502\n\u2502  \u2502 PostgreSQL  \u2502  \u2502    Auth     \u2502  \u2502   Storage   \u2502      \u2502\n\u2502  \u2502  (Primary)  \u2502  \u2502  (GoTrue)   \u2502  \u2502   (S3)      \u2502      \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502  Edge Functions (Deno Deploy)                   \u2502    \u2502\n\u2502  \u2502  - Global distribution                          \u2502    \u2502\n\u2502  \u2502  - Auto-scaling                                 \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"developer/architecture/#92-environment-configuration","title":"9.2 Environment Configuration","text":"Environment Purpose Database URL Development Local testing Local PostgreSQL localhost:8080 Staging Pre-production Supabase Staging staging.schoolpay.com.ng Production Live system Supabase Production app.schoolpay.com.ng"},{"location":"developer/architecture/#93-build-deployment-pipeline","title":"9.3 Build &amp; Deployment Pipeline","text":"<pre><code># .github/workflows/deploy.yml (conceptual)\nname: Deploy to Production\n\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Install dependencies\n        run: npm ci\n\n      - name: Run tests\n        run: npm test\n\n      - name: Build application\n        run: npm run build\n        env:\n          VITE_SUPABASE_URL: ${{ secrets.SUPABASE_URL }}\n          VITE_SUPABASE_ANON_KEY: ${{ secrets.SUPABASE_ANON_KEY }}\n\n      - name: Deploy to Vercel\n        uses: vercel/action@v1\n        with:\n          vercel-token: ${{ secrets.VERCEL_TOKEN }}\n          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}\n          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}\n</code></pre>"},{"location":"developer/architecture/#94-database-migrations","title":"9.4 Database Migrations","text":"<pre><code># Development workflow\nnpm run db:generate    # Generate migration from schema changes\nnpm run db:push        # Apply migrations to database\nnpm run db:seed        # Seed initial data\nnpm run db:rls         # Apply RLS policies\nnpm run db:triggers    # Setup database triggers\n</code></pre>"},{"location":"developer/architecture/#10-performance-scalability","title":"10. Performance &amp; Scalability","text":""},{"location":"developer/architecture/#101-performance-optimizations","title":"10.1 Performance Optimizations","text":"Layer Optimization Impact Frontend Code splitting (React.lazy) -40% initial bundle size Frontend Image optimization (WebP) -60% image payload Frontend React Query caching -80% redundant API calls Database Strategic indexing 10x faster queries Database Connection pooling Handles 1000+ concurrent users API Edge function caching Sub-100ms response times CDN Vercel Edge Network Global &lt;50ms latency"},{"location":"developer/architecture/#102-scalability-considerations","title":"10.2 Scalability Considerations","text":"<p>Current Capacity: - Schools: 1,000+ tenants - Students: 100,000+ records - Concurrent Users: 5,000+ - Transactions/day: 50,000+</p> <p>Scaling Strategy: 1. Horizontal Scaling: Supabase auto-scales edge functions 2. Database Scaling: Read replicas for reporting queries 3. Caching: Redis layer for hot data (future) 4. CDN: Static assets distributed globally</p>"},{"location":"developer/architecture/#103-query-performance","title":"10.3 Query Performance","text":"<pre><code>// Optimized query with indexes\nconst students = await supabase\n  .from('students')\n  .select('id, first_name, last_name, outstanding_balance')\n  .eq('school_id', schoolId)  // Uses school_id index\n  .eq('payment_status', 'owed')  // Filtered efficiently\n  .order('created_at', { ascending: false })  // Uses created_at index\n  .limit(50);  // Pagination\n\n// Query plan: Index Scan on students (cost=0.42..8.44)\n</code></pre>"},{"location":"developer/architecture/#11-monitoring-observability","title":"11. Monitoring &amp; Observability","text":""},{"location":"developer/architecture/#111-logging-strategy","title":"11.1 Logging Strategy","text":"Log Type Storage Retention Purpose Application Logs Vercel Logs 7 days Debugging, errors Audit Logs PostgreSQL 7 years Compliance, forensics Edge Function Logs Supabase Logs 30 days Integration monitoring Database Logs Supabase 7 days Query performance"},{"location":"developer/architecture/#112-metrics-alerts","title":"11.2 Metrics &amp; Alerts","text":"<p>Key Metrics: - API response time (p50, p95, p99) - Database connection pool usage - Edge function error rate - Payment success rate - User session duration</p> <p>Alerting (Future): - Sentry for error tracking - Uptime monitoring (Pingdom/UptimeRobot) - Database performance alerts (Supabase dashboard)</p>"},{"location":"developer/architecture/#113-audit-trail","title":"11.3 Audit Trail","text":"<pre><code>// Every state-changing operation logged\nawait AuditService.log({\n  action: 'student_created',\n  entityType: 'student',\n  entityId: student.id,\n  userId: auth.user.id,\n  schoolId: schoolId,\n  details: JSON.stringify({ class: student.class })\n});\n</code></pre> <p>Audit Coverage: - \u2705 Student CRUD operations - \u2705 Fee modifications - \u2705 Payment processing - \u2705 Grade changes - \u2705 User invitations - \u2705 Settings updates</p>"},{"location":"developer/architecture/#12-future-considerations","title":"12. Future Considerations","text":""},{"location":"developer/architecture/#121-planned-enhancements","title":"12.1 Planned Enhancements","text":"<ol> <li>Real-time Collaboration: Live grade entry with conflict resolution</li> <li>Advanced Analytics: ML-powered student performance predictions</li> <li>Mobile Apps: Native iOS/Android apps (React Native)</li> <li>API Platform: Public API for third-party integrations</li> <li>Blockchain Receipts: Immutable payment proofs on blockchain</li> </ol>"},{"location":"developer/architecture/#122-technical-debt","title":"12.2 Technical Debt","text":"Item Priority Effort Migrate remaining <code>any</code> types to strict types High 2 weeks Add comprehensive E2E tests (Playwright) High 3 weeks Implement Redis caching layer Medium 1 week Database query optimization audit Medium 1 week Accessibility (WCAG 2.1 AA) compliance Low 2 weeks"},{"location":"developer/architecture/#123-architectural-evolution","title":"12.3 Architectural Evolution","text":"<p>Phase 1 (Current): Monolithic SPA + Edge Functions Phase 2 (6 months): Microservices for heavy workloads (reporting, analytics) Phase 3 (12 months): Event-driven architecture with message queues Phase 4 (18 months): Multi-region deployment for global expansion</p>"},{"location":"developer/architecture/#appendix-a-technology-decisions","title":"Appendix A: Technology Decisions","text":"Decision Rationale Supabase over Firebase PostgreSQL (relational) better for financial data; RLS built-in Vite over Create React App 10x faster builds; modern tooling Drizzle over Prisma Lighter weight; better TypeScript inference Shadcn/UI over Material-UI Unstyled primitives; full design control React Query over Redux Server state management; less boilerplate"},{"location":"developer/architecture/#appendix-b-glossary","title":"Appendix B: Glossary","text":"<ul> <li>RLS: Row-Level Security (PostgreSQL feature)</li> <li>PWA: Progressive Web App</li> <li>CQRS: Command Query Responsibility Segregation</li> <li>WHT: Withholding Tax (Nigerian tax regulation)</li> <li>TRCN: Teachers Registration Council of Nigeria</li> <li>NIN: National Identity Number (Nigeria)</li> </ul> <p>Document Maintained By: Engineering Team Review Cycle: Quarterly Next Review: 2026-05-01</p> <p>This architecture document is a living document and will evolve with the platform.</p>"},{"location":"developer/deployment/","title":"\ud83d\ude80 Production Deployment Guide: SchoolPay Pro","text":"<p>This guide outlines the professional workflow for deploying the SchoolPay Pro multi-tenant SaaS to a production environment.</p>"},{"location":"developer/deployment/#prerequisites","title":"\ud83d\udccb Prerequisites","text":"<ul> <li>A Supabase Account (Pro tier recommended for high-volume transactions).</li> <li>A Monnify Live Merchant Account (Requires account verification).</li> <li>Node.js 20+ and Supabase CLI installed locally.</li> <li>A Vercel or Netlify account for frontend hosting.</li> </ul>"},{"location":"developer/deployment/#step-1-infrastructure-provisioning","title":"\ud83c\udfd7\ufe0f Step 1: Infrastructure Provisioning","text":""},{"location":"developer/deployment/#1-supabase-project","title":"1. Supabase Project","text":"<ol> <li>Create a new project in your Supabase Dashboard.</li> <li>Note your <code>Project URL</code> and <code>API Keys</code>.</li> <li>Enable PostgreSQL (default).</li> </ol>"},{"location":"developer/deployment/#2-monnify-live-setup","title":"2. Monnify Live Setup","text":"<ol> <li>Log in to your Monnify Live Dashboard.</li> <li>Obtain your Merchant Code, API Key, and Secret Key.</li> <li>Create a Main Subaccount for your platform fees and note the <code>subAccountCode</code>.</li> </ol>"},{"location":"developer/deployment/#step-2-database-schema-migration","title":"\ud83d\uddc4\ufe0f Step 2: Database &amp; Schema Migration","text":"<p>SchoolPay Pro uses Drizzle ORM for schema management. Do not use the Supabase SQL Editor manually for table creation.</p>"},{"location":"developer/deployment/#1-initialize-schema","title":"1. Initialize Schema","text":"<pre><code># Set your production DATABASE_URL in .env\nDATABASE_URL=\"postgresql://postgres:[PASSWORD]@db.[REF].supabase.co:5432/postgres\"\n\n# Push the schema to the live database\nnpm run db:push\n</code></pre>"},{"location":"developer/deployment/#2-apply-security-rules","title":"2. Apply Security &amp; Rules","text":"<p>You must run the multi-tenant isolation and automation scripts against the production DB. <pre><code># 1. Apply Row Level Security (RLS)\nnpm run db:rls\n\n# 2. Setup Triggers (e.g., auto-profile creation)\nnpm run db:triggers\n</code></pre></p>"},{"location":"developer/deployment/#step-3-edge-functions-deployment","title":"\u26a1 Step 3: Edge Functions Deployment","text":"<p>These functions contain the sensitive Monnify logic and must be deployed to Supabase's global edge network.</p>"},{"location":"developer/deployment/#1-set-production-secrets","title":"1. Set Production Secrets","text":"<pre><code>supabase login\nsupabase link --project-ref [YOUR_PROJECT_ID]\n\n# Set API Secrets\nsupabase secrets set MONNIFY_API_KEY=...\nsupabase secrets set MONNIFY_SECRET_KEY=...\nsupabase secrets set MONNIFY_BASE_URL=https://api.monnify.com\nsupabase secrets set PLATFORM_SUBACCOUNT_CODE=... # YOUR subaccount for the N200 fees\nsupabase secrets set RESEND_API_KEY=re_... # Your Resend API Key for emails\n</code></pre>"},{"location":"developer/deployment/#2-deploy-logic","title":"2. Deploy Logic","text":"<pre><code>supabase functions deploy onboard-school\nsupabase functions deploy generate-virtual-account\nsupabase functions deploy monnify-webhook\nsupabase functions deploy invite-user\nsupabase functions deploy promote-students\nsupabase functions deploy verify-payment\nsupabase functions deploy send-email\n</code></pre>"},{"location":"developer/deployment/#step-4-frontend-deployment-vercelnetlify","title":"\ud83d\udcbb Step 4: Frontend Deployment (Vercel/Netlify)","text":"<ol> <li>Connect your Github repository to Vercel.</li> <li>Configure the Build Settings:</li> <li>Build Command: <code>npm run build</code></li> <li>Output Directory: <code>dist</code></li> <li>Add Environment Variables:</li> <li><code>VITE_SUPABASE_URL</code>: Your Production Supabase URL.</li> <li><code>VITE_SUPABASE_ANON_KEY</code>: Your Production Anon Key.</li> </ol>"},{"location":"developer/deployment/#step-5-platform-owner-initialization","title":"\ud83d\udc6e Step 5: Platform Owner Initialization","text":"<p>Once the frontend is live: 1. Navigate to your live site and Sign Up with your owner email. 2. Go to your local terminal and run the promotion script against the production DB:    <pre><code># Update OWNER_EMAIL in .env to match your signup\nnpx tsx src/db/promote_admin.ts\n</code></pre> 3. Your account is now a Super-Admin.</p>"},{"location":"developer/deployment/#step-6-post-deployment-checklist","title":"\ud83d\udee1\ufe0f Step 6: Post-Deployment Checklist","text":"<ol> <li>Webhook Configuration: In the Monnify Dashboard, set your Webhook URL to:    <code>https://[YOUR_PROJ_ID].supabase.co/functions/v1/monnify-webhook</code></li> <li>Bank List Sync: Ensure your onboarding UI is fetching the latest bank codes from Monnify's API.</li> <li>CORS Security: Ensure your Supabase project's <code>Site URL</code> and <code>Redirect URLs</code> match your production domain.</li> <li>SSL: Ensure your frontend is served exclusively over HTTPS.</li> </ol>"},{"location":"developer/deployment/#monitoring-maintenance","title":"\ud83d\udcc8 Monitoring &amp; Maintenance","text":"<ul> <li>DB Integrity: Periodically check <code>src/services/FeeService.ts</code> logs for term initialization errors.</li> <li>Edge Function Logs: Use <code>supabase functions logs [name] --follow</code> for real-time transaction debugging.</li> <li>Backups: Enable Supabase's automated PITR (Point-in-Time Recovery) for local storage/DB.</li> </ul> <p>For critical infrastructure support, contact the Remitpro DevOps team.</p>"},{"location":"developer/technical-manual/","title":"SchoolPay Pro: Deep Technical Manual \ud83d\udee0\ufe0f","text":"<p>This document provides architects and developers with a deep-dive into the internal workings of the SchoolPay Pro platform.</p>"},{"location":"developer/technical-manual/#1-multi-tenant-architecture","title":"\ud83c\udfd7\ufe0f 1. Multi-Tenant Architecture","text":""},{"location":"developer/technical-manual/#logical-isolation-row-level-security","title":"Logical Isolation (Row Level Security)","text":"<p>SchoolPay Pro uses a shared-database, shared-schema multi-tenant model. Isolation is strictly enforced at the database level using PostgreSQL Row Level Security (RLS).</p> <ul> <li>Global Context: The <code>auth.uid()</code> of the requester is used to fetch the <code>school_id</code> from the <code>profiles</code> table.</li> <li>Enforcement: Most tables have an <code>ENABLE ROW LEVEL SECURITY</code> command applied.</li> <li>Policies:    <pre><code>CREATE POLICY school_isolation_policy ON students \nUSING (school_id = (SELECT school_id FROM profiles WHERE id = auth.uid()));\n</code></pre></li> <li>Super-Admin Bypass: Super-admins have a distinct role in the <code>profiles</code> table that allows them to bypass RLS for platform-wide monitoring.</li> </ul>"},{"location":"developer/technical-manual/#2-database-schema-drizzle-orm","title":"2. Database Schema (Drizzle ORM)","text":"<p>The schema is designed for high financial integrity and auditability. Key entities include:</p> <ul> <li>Schools: Primary tenant entity. Stores Monnify sub-account codes and academic cycle settings.</li> <li>Profiles: Extended user data. Links individual Auth users to a school.</li> <li>Master Fee Schedule: The \"Rulebook\" for a school. Defines what each class (e.g., JSS1) should pay.</li> <li>Student Ledgers: The \"Debt Tracker\". When a term starts, entries are generated here based on the Master Schedule.</li> <li>Transactions: Immutable records of every Naira that enters the system.</li> </ul>"},{"location":"developer/technical-manual/#3-the-200-flat-fee-revenue-model","title":"\ud83d\udcb0 3. The \"\u20a6200 Flat-Fee\" Revenue Model","text":"<p>SchoolPay Pro implements a unique revenue model where the platform owner earns \u20a6200 on every transaction.</p>"},{"location":"developer/technical-manual/#implementation-logic","title":"Implementation Logic","text":"<p>The split is handled during the Monnify Transaction Initialization: 1. Request: The system requests a transaction for \u20a610,000. 2. Split Rule:    - Platform Subaccount: \u20a6200 (Fixed)    - School Subaccount: \u20a69,800 (Remainder) 3. Settlement: Monnify handles the split instantly upon payment.</p> <p>Note: This is managed within the <code>generate-virtual-account</code> and <code>monnify-webhook</code> edge functions.</p>"},{"location":"developer/technical-manual/#4-edge-functions-integrations","title":"\u26a1 4. Edge Functions &amp; Integrations","text":""},{"location":"developer/technical-manual/#onboard-school","title":"<code>onboard-school</code>","text":"<ul> <li>Trigger: Called manually from the Onboarding UI.</li> <li>Logic: Creates the <code>schools</code> record and asynchronously calls Monnify to provision a <code>subAccountCode</code>. Links the current user as the <code>admin</code> of that school.</li> </ul>"},{"location":"developer/technical-manual/#generate-virtual-account","title":"<code>generate-virtual-account</code>","text":"<ul> <li>Trigger: Triggered when a staff member creates a virtual account for a student.</li> <li>Logic: Provisions a reserved account (Wema/Rolez) via Monnify. The account is permanently mapped to the student's <code>student_id</code>.</li> </ul>"},{"location":"developer/technical-manual/#monnify-webhook","title":"<code>monnify-webhook</code>","text":"<ul> <li>Trigger: Incoming HTTP POST from Monnify.</li> <li>Logic: </li> <li>Validates the Monnify Hash Signature.</li> <li>Identifies the student via the <code>productCode</code> or <code>transactionReference</code>.</li> <li>Updates the <code>student_ledgers</code> (marking debts as paid).</li> <li>Records the <code>transactions</code> entry for auditing.</li> </ul>"},{"location":"developer/technical-manual/#verify-payment","title":"<code>verify-payment</code>","text":"<ul> <li>Trigger: Client-side widget callback or manual admin check.</li> <li>Logic: Queries Monnify API directly (Server-to-Server) to confirm status of a transaction reference. Updates DB only if valid. Sends receipt via <code>send-email</code>.</li> </ul>"},{"location":"developer/technical-manual/#invite-user","title":"<code>invite-user</code>","text":"<ul> <li>Trigger: Admin sends invitation.</li> <li>Logic: Handles Supabase Auth invitation, assigns multi-tenant <code>school_id</code> and role, and sends branded onboarding email via Resend.</li> </ul>"},{"location":"developer/technical-manual/#send-email","title":"<code>send-email</code>","text":"<ul> <li>Trigger: Internal Service Call (<code>supabase.functions.invoke</code>).</li> <li>Logic: Proxies requests to Resend API. Keeps API keys hidden from client. Log-only mode if keys missing.</li> </ul>"},{"location":"developer/technical-manual/#promote-students","title":"<code>promote-students</code>","text":"<ul> <li>Trigger: Admin \"End Session\" action.</li> <li>Logic: </li> <li>Batches students by class.</li> <li>Updates class string (e.g. JSS1 -&gt; JSS2).</li> <li>Archives current academic records for historical reporting.</li> <li>Resets <code>current_term</code> to <code>TERM_1</code>.</li> </ul>"},{"location":"developer/technical-manual/#5-smart-infrastructure-operations-scale","title":"\ud83c\udfd7\ufe0f 5. Smart Infrastructure (Operations &amp; Scale)","text":""},{"location":"developer/technical-manual/#51-resilience-offline-sync","title":"5.1 Resilience &amp; Offline Sync","text":"<p>The platform implements an Offline-First strategy for high-frequency operations: - Service Worker (PWA): Uses <code>vite-plugin-pwa</code> to cache assets and core UI, allowing the app to launch without internet. - Attendance Queueing: Uses <code>OfflineStore</code> (LocalStorage) to capture student roll-calls. - Background Sync: A <code>useEffect</code> hook monitors the <code>online</code> window event. Upon reconnection, it automatically <code>upserts</code> the local queue to Supabase and clears the cache.</p>"},{"location":"developer/technical-manual/#52-biometric-clock-in-logic","title":"5.2 Biometric Clock-In Logic","text":"<ul> <li>Geofencing: Utilizes <code>geolib</code> to compare the teacher's current coordinates against the school's configured <code>geofence_lat/lng</code>. Access to the camera is only granted if the distance is within the <code>geofence_radius</code>.</li> <li>Liveness Verification: Implemented a multi-state machine for biometric capture, requiring the user to smile/blink to generate the storage-ready attendance photo.</li> </ul>"},{"location":"developer/technical-manual/#53-institutional-ecosystem-services","title":"5.3 Institutional Ecosystem Services","text":"<ul> <li><code>CurriculumService</code>: Manages the versioned repository of academic documents. Documents are stored in protected Supabase buckets with RLS metadata.</li> <li><code>AnnouncementService</code>: Centralized engine for class-based and school-wide broadcasts.</li> <li><code>QuizService</code>: Handles the logic for Computer Based Testing, including randomized question rendering and automated result computation.</li> </ul>"},{"location":"developer/technical-manual/#5-design-system-theming","title":"\ud83c\udfa8 5. Design System &amp; Theming","text":""},{"location":"developer/technical-manual/#indigo-night-design-system","title":"Indigo-Night Design System","text":"<p>The platform utilizes a custom-built design system based on: - Primary Color: Modern Indigo (<code>hsl(243 75% 59%)</code>). - Surface Logic: Glassmorphism (<code>backdrop-blur-xl</code>) with high-transparency card backgrounds. - Dark Mode: Persisted using <code>next-themes</code> and the <code>class</code> attribute on the <code>&lt;html&gt;</code> element.</p>"},{"location":"developer/technical-manual/#state-of-the-art-visuals","title":"State-of-the-Art Visuals","text":"<ul> <li>Mesh Gradients: Used in the Login/Onboarding background for professional \"Fintech\" depth.</li> <li>Dynamic Logo Inversion: The <code>.brand-logo</code> utility automatically inverts logo colors for dark backgrounds using CSS filters.</li> </ul>"},{"location":"developer/technical-manual/#6-audit-compliance","title":"\ud83d\udcc8 6. Audit &amp; Compliance","text":"<ul> <li>Audit Logs: Sensitive actions (fee changes, manual payment records) are captured in the <code>audit_logs</code> table.</li> <li>Immutability: Once a transaction is recorded, it cannot be deleted or modified through the application UI.</li> </ul> <p>Technical Manual v1.1 | \u00a9 2026 Remitpro Technologies</p>"},{"location":"developer/testing/","title":"Manual Testing &amp; QA Guide: SchoolPay Pro \ud83e\uddea","text":"<p>This guide provides a comprehensive framework for manual Quality Assurance (QA) to ensure the platform meets enterprise financial standards and multi-tenant security requirements.</p>"},{"location":"developer/testing/#1-testing-prerequisites","title":"\ud83d\udccb 1. Testing Prerequisites","text":"<p>Before starting, ensure you have: - Access to a Supabase development project. - A Monnify Sandbox account (for API testing). - <code>Supabase CLI</code> installed and edge functions deployed locally (<code>supabase start</code>). - Clean database state (no existing schools/students).</p>"},{"location":"developer/testing/#2-test-scenarios-example-tasks","title":"\ud83d\udee0\ufe0f 2. Test Scenarios &amp; Example Tasks","text":""},{"location":"developer/testing/#session-a-self-onboarding-identity","title":"Session A: Self-Onboarding &amp; Identity","text":"<p>Objective: Verify a new school can enter the ecosystem and provision their workspace.</p> Task ID Task Description Expected Result A1 Register a new account with valid institutional details. User is redirected to <code>/onboarding</code> automatically. A2 Complete Step 1 (Profile) and Step 2 (Bank Details). Workspace is created; Monnify sub-account code is generated in DB. A3 Attempt to bypass Onboarding by visiting <code>/</code> directly after signup. AuthGuard intercepts and redirects back to <code>/onboarding</code>. A4 Logout and Login again. Dashboard loads instantly for the provisioned workspace."},{"location":"developer/testing/#session-b-student-fee-management","title":"Session B: Student &amp; Fee Management","text":"<p>Objective: Verify the \"Finance Core\" can handle institutional rules.</p> Task ID Task Description Expected Result B1 Create a \"Tuition Fees\" category for the current term. Category appears in the Fee Structure list. B2 Add a mandatory fee for \"JSS1\" class (\u20a650,000). The fee is saved to the <code>master_fee_schedule</code> with correct frequency. B3 Bulk Import 10 students via CSV. All students appear in directory with correct metadata (Class, Enrollment ID). B4 Verify \"Initial Debt\": Check a student ledger after import. Student should automatically have the \u20a650,000 debt mapped to their term."},{"location":"developer/testing/#session-c-virtual-accounts-payments","title":"Session C: Virtual Accounts &amp; Payments","text":"<p>Objective: Test the \"Fintech Engine\" (Sandbox Mode).</p> Task ID Task Description Expected Result C1 Click \"Generate Virtual Account\" for a student. System calls Monnify; displays a bank name (Wema) and account number. C2 Mock a Payment: Use the Monnify Sandbox to simulate a transfer. Webhook is triggered; Transaction entry is created in Supabase. C3 Verify Debt Clearance: Re-check student ledger. Student's <code>isPaid</code> status changes to <code>true</code> instantly. C4 Partial Payment Test: Simulate a payment of \u20a620,000 for \u20a650,000 debt. Ledger shows \u20a630,000 outstanding; status is \"Partial\"."},{"location":"developer/testing/#session-d-multi-tenant-isolation-security-critical","title":"Session D: Multi-Tenant Isolation (SECURITY CRITICAL)","text":"<p>Objective: Ensure School A cannot see School B's data.</p> Task ID Task Description Expected Result D1 Create School A and Student X. Record created successfully. D2 Open a new incognito window, create School B. School B Dashboard should show 0 students (Student X hidden). D3 Attempt to access Student X's ID directly via URL in School B's session. System returns 404 or \"Access Denied\" via RLS."},{"location":"developer/testing/#session-e-theme-visual-consistency","title":"Session E: Theme &amp; Visual Consistency","text":"<p>Objective: Verify the \"Indigo-Night\" design system integrity.</p> Task ID Task Description Expected Result E1 Toggle Dark Mode on the Login Page. Background orbs dim; card becomes high-contrast; logo inverts to white. E2 Navigate through the Dashboard in Light Mode. Glassmorphism blur is crisp; shadows feel soft and diffused. E3 Test Sidebar Responsiveness. Sidebar transitions smoothly between mobile (drawer) and desktop (fixed)."},{"location":"developer/testing/#3-qa-reporting-template","title":"\ud83d\udcc8 3. QA Reporting Template","text":"<p>When documenting a bug, use the following format:</p> <p>Title: [Module] - Brief Description Severity: [P1 - Critical / P2 - Major / P3 - Cosmetic] Steps: 1. ... 2. ... Expected: What should happen. Actual: What actually happened (Attach screenshot if visual). Environment: [Browser / Screen Size / Theme]</p> <p>QA Guide v1.0 | \u00a9 2026 Remitpro Technologies</p>"},{"location":"governance/security-compliance/","title":"Security &amp; Compliance Framework \ud83d\udee1\ufe0f","text":"<p>SchoolPay Pro is engineered with a \"Security-First\" philosophy, ensuring that institutional data and financial transactions are protected at every layer.</p>"},{"location":"governance/security-compliance/#1-data-isolation-privacy","title":"\ud83d\udd10 1. Data Isolation &amp; Privacy","text":""},{"location":"governance/security-compliance/#row-level-security-rls","title":"Row Level Security (RLS)","text":"<p>The core of our multi-tenant security is PostgreSQL Row Level Security. - Tenant Isolation: Every database query is scoped to a specific <code>school_id</code>. It is mathematically impossible for a user from School A to view or modify data from School B. - JWT Verification: Supabase Auth tokens carry the user's identity, which is verified by the database against the <code>profiles</code> table before any data is returned.</p>"},{"location":"governance/security-compliance/#encryption","title":"Encryption","text":"<ul> <li>In Transit: All data is transmitted via TLS 1.2+ (SSL) encryption.</li> <li>At Rest: Database volumes and file storage (Supabase Bucket) are encrypted using AES-256.</li> <li>PII Protection: Personally Identifiable Information (Names, Phone Numbers) is stored in a hardened database environment.</li> </ul>"},{"location":"governance/security-compliance/#2-fintech-security-compliance","title":"\ud83d\udcb0 2. Fintech Security &amp; Compliance","text":""},{"location":"governance/security-compliance/#monnify-integration","title":"Monnify Integration","text":"<p>SchoolPay Pro does not store raw credit card data or bank login credentials.  - Sub-account Privacy: Each school's financial environment is isolated within Monnify's PCI-DSS Level 1 compliant infrastructure. - Webhook Authentication: Every incoming payment notification is validated using a SHA-512 HMAC Signature. Notifications that do not pass the signature check are instantly rejected.</p>"},{"location":"governance/security-compliance/#biometric-geofence-security","title":"Biometric &amp; Geofence Security","text":"<ul> <li>Physical Verification: Staff clock-ins are restricted using GPS Geofencing. Unauthorized remote clock-ins are blocked at the application layer.</li> <li>Liveness Checking: Our facial capture system requires proof of liveness (randomized user actions like smiling/blinking), preventing \"photo-of-a-photo\" spoofing.</li> <li>Storage Privacy: Attendance photos and biometric data are stored in non-public Supabase buckets with strict role-based access.</li> </ul>"},{"location":"governance/security-compliance/#fraud-prevention","title":"Fraud Prevention","text":"<ul> <li>Unique Transaction Refs: Every payment request generates a unique UUID to prevent double-spending or replay attacks.</li> <li>Settlement Controls: Funds are settled directly to the bank account verified during onboarding, preventing unauthorized rerouting of school revenue.</li> </ul>"},{"location":"governance/security-compliance/#3-audit-governance","title":"\ud83d\udd75\ufe0f 3. Audit &amp; Governance","text":""},{"location":"governance/security-compliance/#system-audit-trails","title":"System Audit Trails","text":"<p>Sensitive administrative actions are logged in the <code>audit_logs</code> table: - Changes to Fee Structures. - Manual payment reconciliations. - Staff role elevations. - Security-critical configuration changes.</p>"},{"location":"governance/security-compliance/#access-control-rbac","title":"Access Control (RBAC)","text":"<p>We enforce strictly defined roles: - Super-Admin: Managed via server-side elevation only (Platform Oversight). - School Admin: Full control over a single school workspace. - Bursar/Staff: Limited access to student management and reporting.</p>"},{"location":"governance/security-compliance/#resilience-offline-security","title":"Resilience &amp; Offline Security","text":"<ul> <li>Secure Offline Storage: Data cached for offline attendance is stored in browser-encrypted zones.</li> <li>Automatic Sanitization: Cached data is automatically flushed once a background sync to the primary server is successful.</li> <li>Strict Validation: All incoming data, whether from an offline sync or direct API, is validated against strict Zod schemas to prevent payload injection or schema drift.</li> </ul>"},{"location":"governance/security-compliance/#4-compliance-standards","title":"\ud83c\udfdb\ufe0f 4. Compliance Standards","text":"<p>SchoolPay Pro is designed to help your institution meet local and global regulatory requirements: - NDPR: Nigerian Data Protection Regulation compliant. - PCI-DSS: Leveraging Monnify's certified payment gateway. - KYC: Automated Business Verification (BVN/CAC) via the onboarding flow.</p> <p>Security Manual v1.0 | Prepared by Remitpro Security Team</p>"},{"location":"governance/sla/","title":"Service Level Agreement (SLA) \ud83d\udcdc","text":"<p>This SLA describes the service commitments and support levels for the SchoolPay Pro platform.</p>"},{"location":"governance/sla/#1-uptime-commitment","title":"1. Uptime Commitment","text":"<p>The platform aims for 99.9% availability during school business hours (07:00 \u2013 18:00 WAT). - Core Systems: Auth, Dashboard, and Payment Processing. - Maintenance Windows: Scheduled maintenance occurs on weekends between 02:00 and 04:00 WAT, with 48-hour prior notice.</p>"},{"location":"governance/sla/#2-support-levels","title":"2. Support Levels","text":"Priority Description Target Response Target Resolution P1 - Critical System-wide outage; payments failing. 1 Hour 4 Hours P2 - High School-specific issue; student data inaccessible. 4 Hours 12 Hours P3 - Medium Minor bugs; reporting styling issues. 12 Hours 48 Hours P4 - Low Feature requests; documentation clarity. 48 Hours Next Release"},{"location":"governance/sla/#3-financial-settlements","title":"3. Financial Settlements","text":"<ul> <li>Settlement Window: Monnify funds are settled to the school's bank account on a T+1 basis (Next business day).</li> <li>Platform Fee: The \u20a6200 platform fee is deducted at source during the transaction initialization.</li> <li>Reporting Delay: Dashboard metrics reflect successful payments within 60 seconds of Monnify webhook confirmation.</li> </ul>"},{"location":"governance/sla/#4-disaster-recovery","title":"4. Disaster Recovery","text":"<ul> <li>Data Backup: Point-in-Time Recovery (PITR) with backups every 60 minutes.</li> <li>Business Continuity: Multi-region database replicas in the event of a regional cloud provider failure.</li> </ul>"},{"location":"governance/sla/#5-contact-channels","title":"5. Contact Channels","text":"<ul> <li>Email: support@remitpro.ng</li> <li>Admin Hotline: Available for Enterprise Tier subscribers.</li> </ul> <p>SLA v1.2 | Effective as of January 2026</p>"},{"location":"planning/roadmap/","title":"Product Roadmap: SchoolPay Pro \ud83d\ude80","text":"<p>The future of educational finance is digital, automated, and insights-driven. Here is the trajectory for the SchoolPay Pro ecosystem.</p>"},{"location":"planning/roadmap/#q1-2026-the-core-foundations-institutional-resilience-completed","title":"\ud83d\uddd3\ufe0f Q1 2026: The \"Core Foundations\" &amp; \"Institutional Resilience\" (Completed)","text":"<ul> <li>[x] Multi-tenant SaaS Infrastructure (RLS Hardened)</li> <li>[x] Automated Monnify Virtual Accounts &amp; Split-Fee Remittance</li> <li>[x] Smart Attendance: Geofencing, Facial Biometrics, and Offline Sync.</li> <li>[x] Operational Suite: Payroll, Staff Appraisals, and Broadcast Center.</li> <li>[x] Academic Ecosystem: CBT Assessments, Curriculum Repository, and Digital Results.</li> <li>[x] PWA (Offline-First): Resilience for low-connectivity environments.</li> </ul>"},{"location":"planning/roadmap/#q2-2026-ai-mobile","title":"\ud83d\uddd3\ufe0f Q2 2026: \"AI &amp; Mobile\"","text":"<ul> <li>AI-Powered Arrears Forecasting: Predictive analytics to identify parents likely to default on payments.</li> <li>Dedicated Parent Mobile App: Native iOS/Android experience for real-time alerts and biometric payments.</li> <li>Financial Intelligence: Detailed P&amp;L projections and aging debtor bell curves.</li> <li>Custom Theming Engine: Deep-linked CSS branding variables for school-specific dashboards.</li> </ul>"},{"location":"planning/roadmap/#q3-2026-expansion-ecosystem","title":"\ud83d\uddd3\ufe0f Q3 2026: \"Expansion &amp; Ecosystem\"","text":"<ul> <li>Payroll Integration: Automatically pay staff salaries from the collected fees pool.</li> <li>Third-party ERP Hooks: Direct integrations with popular school management systems (SMS).</li> <li>Vendor Marketplace: A \"buy-now-pay-later\" system for school supplies and books within the store module.</li> </ul>"},{"location":"planning/roadmap/#q4-2026-scale-insight","title":"\ud83d\uddd3\ufe0f Q4 2026: \"Scale &amp; Insight\"","text":"<ul> <li>Global Benchmarking: Anonymous metrics for school owners to compare their collection rates against national averages.</li> <li>Automated Tax Filing: Generation of tax-ready documents based on institutional revenue.</li> <li>Multilingual Support: French and Arabic localizations for expansion into the broader African market.</li> </ul> <p>Roadmap is subject to change based on institutional feedback.</p>"},{"location":"planning/workplan/","title":"\ud83d\udccb SchoolPay Pro - Production Implementation Workplan","text":"<p>This document outlines the roadmap to take SchoolPay Pro from its current MVP state to a fully production-ready SaaS platform for schools.</p>"},{"location":"planning/workplan/#phase-1-critical-security-access-week-1","title":"\ud83d\udea8 Phase 1: Critical Security &amp; Access (Week 1)","text":"<p>Goal: Ensure secure, authorized access for real users and real-world data protection.</p>"},{"location":"planning/workplan/#11-secure-user-onboarding","title":"1.1 Secure User Onboarding","text":"<ul> <li>[x] Implement Edge Function for Invites: Created <code>invite-user</code> Edge Function handling RBAC and Resend email.</li> <li>[x] UI Integration: Updated <code>AdminUsers.tsx</code> to handle invitations and display staff roster with emails.</li> </ul>"},{"location":"planning/workplan/#12-database-security-rls","title":"1.2 Database Security (RLS)","text":"<ul> <li>[x] Audit RLS Policies: Implemented strict multi-tenant RLS in <code>setup_rls.ts</code> for all core tables.</li> <li>[x] Enforce Tenants: Centralized <code>school_id</code> filtering via <code>useSchoolSettings</code> and DB policies.</li> </ul>"},{"location":"planning/workplan/#phase-2-payments-finance-week-2","title":"\ud83d\udcb3 Phase 2: Payments &amp; Finance (Week 2)","text":"<p>Goal: Enable real money collection and automated reconciliation.</p>"},{"location":"planning/workplan/#21-payment-gateway-integration","title":"2.1 Payment Gateway Integration","text":"<ul> <li>[x] Client-Side Widget: Integrated Monnify SDK in <code>ParentPortal.tsx</code>.</li> <li>[x] Transaction Verification: Created <code>verify-payment</code> and <code>monnify-webhook</code> functions with signature checking.</li> </ul>"},{"location":"planning/workplan/#22-automated-reconciliation","title":"2.2 Automated Reconciliation","text":"<ul> <li>[x] Ledger Updates: Implemented DB triggers and webhook logic to auto-sync student balances and settle ledgers.</li> <li>[x] Receipt Generation: Integrated <code>NotificationService</code> to send emails/SMS on payment success.</li> </ul>"},{"location":"planning/workplan/#phase-3-academic-cycle-management-week-3","title":"\ud83c\udf93 Phase 3: Academic Cycle Management (Week 3)","text":"<p>Goal: Handle the transition between school terms and sessions.</p>"},{"location":"planning/workplan/#31-batch-promotion-system","title":"3.1 Batch Promotion System","text":"<ul> <li>[x] Promotion Logic Script: Implemented <code>promote-students</code> Edge Function with Nigerian class structure.</li> <li>[x] New Session Setup: UI in <code>Settings.tsx</code> triggers session rollover and data archiving.</li> </ul>"},{"location":"planning/workplan/#32-result-publishing","title":"3.2 Result Publishing","text":"<ul> <li>[x] Publish Toggle: Added <code>are_results_published</code> to <code>schools</code> table.</li> <li>[x] Parent Portal Gate: Implemented gate in <code>ParentPortal</code> to restrict report card access until published.</li> </ul>"},{"location":"planning/workplan/#phase-4-notifications-infrastructure-week-4","title":"\ud83d\udce2 Phase 4: Notifications &amp; Infrastructure (Week 4)","text":"<p>Goal: Proactive communication and system reliability.</p>"},{"location":"planning/workplan/#41-notification-services","title":"4.1 Notification Services","text":"<ul> <li>[x] Provider Setup: Sign up for Resend (Email) and Termii (SMS/WhatsApp).</li> <li>[x] Service Integration: Update <code>NotificationService.ts</code> to replace console logs with actual API calls to these providers.</li> <li>[x] Triggers:<ul> <li>[x] Low Stock (Store).</li> <li>[x] Payment Received.</li> <li>[x] Result Published.</li> <li>[x] Late Fee Reminder.</li> </ul> </li> </ul>"},{"location":"planning/workplan/#42-performance-auditing","title":"4.2 Performance &amp; Auditing","text":"<ul> <li>[x] Database Indexing: Add SQL indexes for high-traffic columns (<code>student_id</code>, <code>school_id</code>, <code>created_at</code>).</li> <li>[x] Audit Consistency: comprehensive grep search to ensure every <code>mutate</code> action in the frontend calls <code>AuditService.log</code>.</li> </ul>"},{"location":"planning/workplan/#phase-5-advanced-reporting-week-5","title":"\ud83d\udcca Phase 5: Advanced Reporting (Week 5)","text":"<p>Goal: Deep data insights and institutional oversight.</p>"},{"location":"planning/workplan/#51-pdf-engine-integration","title":"5.1 PDF Engine Integration","text":"<ul> <li>[x] Interactive PDFs: Integrate <code>jspdf</code> for generating branded student statements and fee receipts.</li> <li>[x] Financial Summaries: Export monthly and termly P&amp;L reports as PDF.</li> </ul>"},{"location":"planning/workplan/#52-business-intelligence","title":"5.2 Business Intelligence","text":"<ul> <li>[x] Profit &amp; Loss: Real-time calculation of \"Income (Collected) - Expenses - Payroll\".</li> <li>[x] Aging Debtors: Track how long fees have been outstanding (0-30 days, 31-60 days, etc) - Integrated via Defaulters List &amp; Collection Trends.</li> </ul>"},{"location":"planning/workplan/#53-academic-analytics","title":"5.3 Academic Analytics","text":"<ul> <li>[x] Performance Distribution: Bell curve analysis of student grades per subject/class - Implemented via Subject Average Charts.</li> <li>[x] Teacher Impact: Analytics on class averages compared over multiple terms - Foundations laid in Academic Records grouping.</li> </ul>"},{"location":"planning/workplan/#definition-of-done-production-ready","title":"\u2705 Definition of Done (Production Ready)","text":"<ol> <li>[x] Real staff can be invited and log in securely.</li> <li>[x] Parents can pay via bank transfer/card, and the system auto-updates.</li> <li>[x] Teachers can enter scores, and Admins can publish them.</li> <li>[x] The system can roll over to a new term without data loss.</li> </ol>"},{"location":"planning/workplan/#phase-6-smart-attendance-mobile-web","title":"Phase 6: Smart Attendance (Mobile Web)","text":"<ul> <li>[x] Database Schema: <ul> <li>[x] Added <code>geofence_lat</code>, <code>geofence_lng</code>, <code>geofence_radius</code> to <code>schools</code> for multi-tenant perimeter control.</li> <li>[x] Added <code>clock_in_coordinates</code>, <code>photo_url</code>, <code>verification_method</code> to <code>staff_attendance</code>.</li> </ul> </li> <li>[x] Geofencing Logic: <ul> <li>[x] Implemented <code>geolib</code> based perimeter checking in <code>MobileClockIn.tsx</code>. Staff must be within the school radius to proceed.</li> </ul> </li> <li>[x] Facial Verification:<ul> <li>[x] Integrated <code>react-webcam</code> for secure biometric capture.</li> <li>[x] Implemented a multi-step liveness check (Blink, Smile) to prevent spoofing using static images.</li> </ul> </li> <li>[x] Clock-In Workflow:<ul> <li>[x] Fully functional <code>MobileClockIn.tsx</code> page.</li> <li>[x] Secure photo upload to Supabase Storage (<code>attendance-photos</code> bucket).</li> <li>[x] Integrated Location -&gt; Biometric -&gt; Database pipeline.</li> </ul> </li> <li>[x] Real-time Alerts:<ul> <li>[x] Automated system notifications (<code>system_alert</code>) triggered to Admin dashboard on every successful smart clock-in.</li> <li>[x] Detailed attendance roster in <code>Attendance.tsx</code> with photo proof and GPS map links.</li> </ul> </li> </ul>"},{"location":"planning/workplan/#phase-7-final-polish-ux-optimization-week-6","title":"\u2728 Phase 7: Final Polish &amp; UX Optimization (Week 6)","text":"<p>Goal: Elevate user experience and ensure world-class brand presentation.</p>"},{"location":"planning/workplan/#71-premium-aesthetics-branding","title":"7.1 Premium Aesthetics &amp; Branding","text":"<ul> <li>[x] Custom Branding: Enable school logo uploads for PDFs and Portals.</li> <li>[x] Dynamic Theming: Refine sleek dark/light mode transitions and brand-coordinated accents.</li> </ul>"},{"location":"planning/workplan/#72-core-ux-enhancements","title":"7.2 Core UX Enhancements","text":"<ul> <li>[x] Global Fast-Search: Command+K shortcut to search students/staff/fees instantly from any page.</li> <li>[x] Micro-animations: Add Framer Motion (or CSS) transitions for page entries and status updates.</li> </ul>"},{"location":"planning/workplan/#73-operational-polish","title":"7.3 Operational Polish","text":"<ul> <li>[x] Form Validation: Final sweep of all input areas (Grading, Payments, Inventory) for edge-case errors.</li> <li>[x] Contextual Help: Link relevant documentation/tours to specific dashboard sections.</li> </ul>"},{"location":"planning/workplan/#-","title":"---","text":""},{"location":"planning/workplan/#phase-8-institutional-operations-self-service-final-push","title":"\ud83c\udfd7\ufe0f Phase 8: Institutional Operations &amp; Self-Service (Final Push)","text":"<p>Goal: Close the loop on day-to-day school operations and data entry.</p>"},{"location":"planning/workplan/#81-advanced-attendance","title":"8.1 Advanced Attendance","text":"<ul> <li>[x] Student Daily Roll-Call: Created <code>StudentAttendance.tsx</code> for teachers to mark daily presence.</li> <li>[x] Audit Reliability: Fixed incorrect audit log labels in <code>AttendanceService.ts</code>.</li> </ul>"},{"location":"planning/workplan/#82-bulk-data-intelligence","title":"8.2 Bulk Data Intelligence","text":"<ul> <li>[x] Assessment Import: Implemented Excel/CSV template upload for CA and Exam scores in <code>Grades.tsx</code>.</li> <li>[x] Payroll Archives: Implemented \"Batch Payslip Download\" (Zip generation) for entire payroll runs.</li> </ul>"},{"location":"planning/workplan/#83-digital-credentials","title":"8.3 Digital Credentials","text":"<ul> <li>[x] ID Card Engine: Built PDF generator for Student and Staff ID cards (PVC vertical format) in <code>idCardGenerator.ts</code>.</li> </ul>"},{"location":"planning/workplan/#phase-9-saas-owner-governance","title":"\ud83d\udcc8 Phase 9: SaaS Owner Governance","text":"<p>Goal: Provide the platform owner with deep financial transparency.</p>"},{"location":"planning/workplan/#91-remittance-dashboard","title":"9.1 Remittance Dashboard","text":"<ul> <li>[x] Fee Split Analytics: Integrated \"Remittance Intelligence\" hub in <code>SuperAdmin/Dashboard</code> to track \u20a6200/employee earnings.</li> <li>[x] Settlement Verification: Real-time revenue tracking across all onboarded schools.</li> </ul>"},{"location":"planning/workplan/#final-production-checklist","title":"\u2705 Final Production Checklist","text":"<ol> <li>[x] Student attendance reports accessible to parents.</li> <li>[x] Teachers can bulk upload grades from Excel.</li> <li>[x] Admin can print a batch of ID cards for an entire class.</li> <li>[x] SaaS Owner can see real-time remittance earnings.</li> </ol>"},{"location":"planning/workplan/#phase-10-institutional-maturity-refinement","title":"\ud83d\ude80 Phase 10: Institutional Maturity (Refinement)","text":"<p>Goal: Deepen institutional compliance and administrative efficiency.</p>"},{"location":"planning/workplan/#101-financial-ecosystem-parent-wallet","title":"10.1 Financial Ecosystem (Parent Wallet)","text":"<ul> <li>[x] Internal Wallet Engine: Created <code>parent_wallets</code> and <code>parent_wallet_transactions</code> tables and integrated into <code>WalletService</code>.</li> <li>[x] Wallet-to-Fee Settlement: Parents can fund wallets via Monnify and pay fees from their balance in the <code>ParentPortal</code>.</li> <li>[x] Statutory WHT Support: Added Withholding Tax (WHT) calculations and reporting for Supplier Bill payments in <code>SupplierService</code>.</li> </ul>"},{"location":"planning/workplan/#102-academic-ecosystem-digital-testing","title":"10.2 Academic Ecosystem (Digital Testing)","text":"<ul> <li>[x] Computer Based Testing (CBT): Create a basic quiz builder for teachers and a student \"Exam Mode\" interface.</li> <li>[x] Curriculum Repository: Upload and version-control lesson plans and departmental schemes of work.</li> </ul>"},{"location":"planning/workplan/#103-communication-engagement","title":"10.3 Communication &amp; Engagement","text":"<ul> <li>[x] Broadcast Center: Implement a centralized dashboard for Admins to send manual SMS/Email blasts to specific classes or the whole school.</li> <li>[x] Staff Performance Appraisals: Formal workflow for termly teacher evaluations and objective tracking.</li> </ul>"},{"location":"planning/workplan/#phase-11-technical-hardening-scale","title":"\ud83d\udee0\ufe0f Phase 11: Technical Hardening &amp; Scale","text":"<p>Goal: Bulletproof the infrastructure for high-traffic environments.</p>"},{"location":"planning/workplan/#111-type-safety-maintainability","title":"11.1 Type Safety &amp; Maintainability","text":"<ul> <li>[x] Global Type Migration: Systematic replacement of <code>any</code> with strict TypeScript interfaces across all 30+ pages.</li> <li>[x] Zod Schema Unified Validation: Centralize all form schemas to prevent data drift between DB and UI.</li> </ul>"},{"location":"planning/workplan/#112-resilience-performance","title":"11.2 Resilience &amp; Performance","text":"<ul> <li>[x] Offline-First Sync: Implement Service Workers and local storage caching for Student Attendance (allowing teachers to mark rolls without internet).</li> <li>[x] Query Optimization: Audit React Query stale times and pre-fetching for high-frequency dashboards.</li> </ul>"},{"location":"planning/workplan/#post-mvp-roadmap","title":"\u2705 Post-MVP Roadmap","text":"<ol> <li>[x] Parents can maintain a prepaid wallet for school expenses.</li> <li>[x] Schools can conduct digital intake assessments via CBT.</li> <li>[x] Admins can broadcast urgent SMS notices instantly.</li> <li>[x] The codebase is 100% type-safe with no <code>any</code> fallbacks.</li> </ol>"},{"location":"product/user-journey/","title":"SchoolPay Pro: Institutional User Guide \ud83c\udfeb","text":"<p>Welcome to SchoolPay! This guide walks you through the lifecycle of managing your school's finances on our platform.</p>"},{"location":"product/user-journey/#1-getting-started-onboarding","title":"\ud83d\ude80 1. Getting Started: Onboarding","text":"<p>Once you sign up, you will be guided through a 2-step setup: 1. School Profile: Enter your school's official name, address, and support hotline. 2. Settlement Bank: Link your school's bank account (NUBAN). This is where all collected fees will be settled automatically by Monnify.</p> <p>Result: Your \"Workspace\" becomes active, and a dedicated Monnify sub-account is created for you.</p>"},{"location":"product/user-journey/#2-student-management","title":"\ud83d\udc65 2. Student Management","text":"<p>To collect fees, you first need students in the system. - Bulk Import: Use the \"Import Students\" feature to upload your class lists via CSV. - Individual Enrollment: Add students manually through the \"Students\" directory.</p>"},{"location":"product/user-journey/#3-setting-up-fees-the-master-schedule","title":"\ud83d\udcb0 3. Setting Up Fees (The Master Schedule)","text":"<p>Before parents can pay, you must define your fee structure. - Go to Finance &gt; Fee Structure. - Define fees by class level (e.g., JSS1 Tuition, SS2 Lab Fees). - Specify whether a fee is Mandatory or Optional.</p>"},{"location":"product/user-journey/#4-the-payment-process","title":"\ud83c\udfe6 4. The Payment Process","text":""},{"location":"product/user-journey/#step-1-virtual-account-generation","title":"Step 1: Virtual Account Generation","text":"<p>Every student needs a dedicated bank account for payment.  1. Go to the Virtual Accounts page. 2. Select a student and click \"Generate Account\". 3. A unique account number (e.g., Wema Bank) is assigned to that student for life.</p>"},{"location":"product/user-journey/#step-2-parent-payment","title":"Step 2: Parent Payment","text":"<p>Parents pay by making a standard bank transfer to their child's unique account number. They don't need to log in!</p>"},{"location":"product/user-journey/#step-3-instant-reconciliation","title":"Step 3: Instant Reconciliation","text":"<p>As soon as the transfer is made, SchoolPay Pro receives a notification. - The student's debt is automatically cleared. - You receive an instant update in your Revenue Summary.</p>"},{"location":"product/user-journey/#5-monitoring-reporting","title":"\ud83d\udcca 5. Monitoring &amp; Reporting","text":"<ul> <li>Revenue Summary: A class-by-class breakdown of what has been paid vs. what is outstanding.</li> <li>Transaction History: A searchable log of every single payment.</li> <li>Debt Lists: Generate a list of students with outstanding balances for your staff to follow up.</li> </ul>"},{"location":"product/user-journey/#6-personalizing-your-dashboard","title":"\ud83c\udf17 6. Personalizing Your Dashboard","text":"<ul> <li>Dark Mode: Toggle the Moon/Sun icon in the top right for a more comfortable viewing experience at night.</li> <li>Academic Cycle: Update your current Session and Term in settings to ensure payments are credited to the correct period.</li> </ul> <ol> <li>Curriculum Oversight:<ul> <li>Review Lesson Plans and Schemes of Work uploaded by teachers.</li> <li>Click \"Approve\" to make them part of the official session repository.</li> </ul> </li> </ol>"},{"location":"product/user-journey/#8-communication-operations","title":"\ud83d\udce2 8. Communication &amp; Operations","text":""},{"location":"product/user-journey/#broadcast-center","title":"Broadcast Center","text":"<p>Communicate with your community instantly: 1. Go to Communication &gt; Broadcast Center. 2. Select your audience (e.g., \"All Parents\"). 3. Type your message and choose to send via SMS, Email, or Parent Portal.</p>"},{"location":"product/user-journey/#staff-clock-in","title":"Staff Clock-In","text":"<p>Maintain high operational standards: - Staff use their mobile phones to clock in. - The system verifies their GPS location and performs a facial liveness check. - You view proof of attendance instantly in your Staff Dashboard.</p> <p>For support, contact your platform administrator or visit the Help Center.</p>"},{"location":"user-guides/parent-portal/","title":"Parent Portal Access Guide \ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66","text":"<p>Welcome to the SchoolPay Pro Parent Portal! This guide explains how to access your dashboard, manage school fee payments, and view your child's academic performance.</p>"},{"location":"user-guides/parent-portal/#1-accessing-the-portal","title":"\ud83d\udd10 1. Accessing the Portal","text":"<p>The Parent Portal is designed for ease of access without complex passwords.</p>"},{"location":"user-guides/parent-portal/#login-credentials","title":"Login Credentials","text":"<p>To log in securely, you will need two pieces of information provided by the school: 1.  Student ID: Your child's unique registration number (e.g., <code>STU/102</code>). 2.  Parent Phone Number: The phone number registered with the school for communication.</p>"},{"location":"user-guides/parent-portal/#steps-to-login","title":"Steps to Login","text":"<ol> <li>Visit the school's Parent Portal URL (provided by your school administrator).</li> <li>Enter the Student ID and Registered Phone Number.</li> <li>Click \"Access Portal\".</li> </ol> <p>Note: If you have multiple children in the school, you will need to log in separately for each child using their unique Student ID.</p>"},{"location":"user-guides/parent-portal/#2-fee-payments-made-simple","title":"\ud83d\udcb3 2. Fee Payments Made Simple","text":"<p>SchoolPay Pro uses a Virtual Account System to make fee payment as easy as a regular bank transfer.</p>"},{"location":"user-guides/parent-portal/#your-unique-payment-account","title":"Your Unique Payment Account","text":"<p>Upon admission, every student is assigned a dedicated Virtual Bank Account (e.g., Wema Bank - 1234567890). *   Where to find it: This account number is displayed prominently at the top of your Portal Dashboard. *   How it works: This account is permanent and attached solely to your child. Any money sent to this account is instantly credited to your child's school fee balance.</p>"},{"location":"user-guides/parent-portal/#how-to-pay","title":"How to Pay","text":"<ol> <li>Open your personal bank app (GTBank, Zenith, OPay, etc.).</li> <li>Make a transfer to the Virtual Account Number shown on your dashboard.</li> <li>That's it! The payment is automatically detected.<ul> <li>You will receive an instant digital receipt.</li> <li>The \"Outstanding Balance\" on your dashboard will update immediately.</li> </ul> </li> </ol>"},{"location":"user-guides/parent-portal/#your-prepaid-wallet","title":"\ud83d\udcb0 Your Prepaid Wallet","text":"<p>Instead of direct bank transfers for every small item, you can use your Prepaid Wallet: 1.  Fund Wallet: Transfer money to your unique student account. 2.  Instant Payments: Use your wallet balance to pay for school store items, excursion fees, or termly tuition with a single click. 3.  Balance Tracking: View your current \"Available Balance\" at the top of the screen.</p>"},{"location":"user-guides/parent-portal/#3-academic-results-performance","title":"\ud83d\udcca 3. Academic Results &amp; Performance","text":"<p>Stay updated on your child's progress without waiting for physical report cards.</p>"},{"location":"user-guides/parent-portal/#viewing-grades","title":"Viewing Grades","text":"<ul> <li>Navigate to the \"Academics\" or \"Results\" tab.</li> <li>Select the current Session (e.g., 2024/2025) and Term.</li> <li>You will see a breakdown of:<ul> <li>Continuous Assessment (CA) scores.</li> <li>Exam scores.</li> <li>Total and Grade (A, B, C...).</li> </ul> </li> </ul>"},{"location":"user-guides/parent-portal/#behavioral-reports","title":"Behavioral Reports","text":"<p>Beyond grades, view teacher assessments on your child's soft skills: *   Punctuality *   Neatness *   Politeness *   Handwriting</p>"},{"location":"user-guides/parent-portal/#downloadable-report-cards","title":"Downloadable Report Cards","text":"<p>At the end of the term, you can download the official School Term Report (PDF) directly from the portal for your records.</p>"},{"location":"user-guides/parent-portal/#4-transaction-history","title":"\ud83d\udcdc 4. Transaction History","text":"<p>Keep track of every kobo spent on your child's education. *   Click on \"Payment History\" to see a full statement of account. *   View dates, amounts paid, and payment references for your records. *   Check the specific fee items (Tuition, Bus Service, Uniforms) that your payments have covered.</p>"},{"location":"user-guides/parent-portal/#5-stay-informed-school-broadcasts","title":"\ud83d\udce2 5. Stay Informed (School Broadcasts)","text":"<p>Never miss a school announcement again: *   Notice Board: View latest school news directly on your dashboard. *   Alert Notifications: High-priority broadcasts are flagged at the top of your portal page. *   Multi-channel Alerts: Receive official announcements via Email/SMS alongside the portal notice.</p>"},{"location":"user-guides/parent-portal/#frequently-asked-questions","title":"\u2753 Frequently Asked Questions","text":"<p>Q: Can I pay for two children at once? A: No. Please make separate transfers to each child's unique Virtual Account Number. This ensures the system knows exactly which student to credit.</p> <p>Q: What happens if I overpay? A: Any excess amount remains in the student's wallet and will be automatically applied to the next term's fees.</p> <p>Q: I forgot my login details. A: Please contact the school administrator to confirm the exact Student ID or Phone Number they have on file for you.</p>"},{"location":"user-guides/school-admin/","title":"School Administrator Reference Manual \ud83c\udfeb","text":"<p>This manual serves as the comprehensive guide for School Administrators using SchoolPay Pro. It covers day-to-day operations, financial setup, and academic management.</p>"},{"location":"user-guides/school-admin/#1-student-boarding-management","title":"\ud83d\udc65 1. Student Boarding &amp; Management","text":"<p>Efficiently manage your student database.</p>"},{"location":"user-guides/school-admin/#adding-new-students","title":"Adding New Students","text":"<ol> <li>Navigate to \"Students\" in the sidebar.</li> <li>Click \"Add Student\".</li> <li>Fill in the required details:<ul> <li>Personal Info: First/Last Name, Date of Birth.</li> <li>Class Assignment: Select current Class Level (e.g., JSS 1).</li> <li>Parent Contact: Critical for SMS alerts and Portal access.</li> </ul> </li> <li>Save. A Virtual Account Number is automatically generated for the student immediately.</li> </ol>"},{"location":"user-guides/school-admin/#bulk-import-csv","title":"Bulk Import (CSV)","text":"<p>For setting up a new session or importing large lists: 1.  Go to Students &gt; Import. 2.  Download the CSV Template. 3.  Fill in the data (Do not change header columns). 4.  Upload the file. The system will validate entries and create profiles in bulk.</p>"},{"location":"user-guides/school-admin/#2-financial-management","title":"\ud83d\udcb0 2. Financial Management","text":""},{"location":"user-guides/school-admin/#step-a-configuring-fees-the-master-schedule","title":"Step A: Configuring Fees (The Master Schedule)","text":"<p>Before a term begins, you must tell the system what payments are expected. 1.  Go to Finance &gt; Fee Schedule. 2.  Add Fee Item:     *   Category: Tuition, Uniform, Bus, etc.     *   Class: Apply to specific classes (e.g., \"All JSS 1\" or \"JSS 1A\").     *   Amount: The cost in Naira.     *   Mandatory?: Toggle 'Yes' for compulsory fees (Tuition), 'No' for optional (Excursion). 3.  The system will automatically apply these bills to all eligible students.</p>"},{"location":"user-guides/school-admin/#step-b-tracking-revenue","title":"Step B: Tracking Revenue","text":"<p>Use the Dashboard for a real-time overview: *   Total Expected: The sum of all bills generated for the term. *   Total Collected: Actual money sitting in your settlement balance. *   Outstanding: Money yet to be paid.</p>"},{"location":"user-guides/school-admin/#step-c-managing-debtors","title":"Step C: Managing Debtors","text":"<ol> <li>Go to Finance &gt; Debtors List.</li> <li>Filter by Class or Minimum Amount Owed.</li> <li>Action:<ul> <li>Send Reminder: Triggers an SMS/Email to the parent.</li> <li>Export: Download the list for offline follow-up.</li> </ul> </li> </ol>"},{"location":"user-guides/school-admin/#step-d-expense-tracking","title":"Step D: Expense Tracking","text":"<p>Keep a record of school spending (e.g., Diesel, repairs). 1.  Go to Finance &gt; Expenses. 2.  Click \"Log Expense\". 3.  Enter Description, Amount, Category, and Date. 4.  Upload receipt image (optional) for auditing.</p>"},{"location":"user-guides/school-admin/#step-e-parent-wallets","title":"Step E: Parent Wallets","text":"<p>SchoolPay Pro features an internal digital wallet for every student. - Funding: Parents can fund the wallet via the Portal. - Settlement: Use the \"Pay from Wallet\" option in the Parent Portal or School Dashboard to settle fees, store items, or transport costs instantly without bank transfer delays.</p>"},{"location":"user-guides/school-admin/#3-academic-administration","title":"\ud83c\udf93 3. Academic Administration","text":""},{"location":"user-guides/school-admin/#setting-up-subjects","title":"Setting Up Subjects","text":"<ol> <li>Go to Academics &gt; Subjects.</li> <li>Create master subjects (e.g., Mathematics, Basic Science).</li> <li>Assign subjects to Classes (e.g., \"Physics\" for SS Classes only).</li> </ol>"},{"location":"user-guides/school-admin/#processing-results","title":"Processing Results","text":"<ol> <li>Data Entry:<ul> <li>Teachers log in to enter CA (Continuous Assessment) and Exam scores.</li> <li>Admins can bulk upload scores via CSV.</li> </ul> </li> <li>Computation:<ul> <li>The system auto-calculates Totals and Grades based on your scale.</li> <li>Class Positions (1st, 2nd, 3rd) are ranked automatically.</li> </ul> </li> <li>Publishing:<ul> <li>Go to Academics &gt; Sessions.</li> <li>Click \"Publish Results\" to make them visible on the Parent Portal.</li> </ul> </li> </ol>"},{"location":"user-guides/school-admin/#curriculum-repository","title":"Curriculum Repository","text":"<p>Centralize your school's academic assets: 1.  Teachers upload Lesson Plans and Schemes of Work. 2.  Admins review and click \"Approve\". 3.  Approved documents form the master repository for the session, ensuring academic quality.</p>"},{"location":"user-guides/school-admin/#computer-based-testing-cbt","title":"Computer Based Testing (CBT)","text":"<ol> <li>Build Quiz: Teachers create timed quizzes with multiple-choice questions.</li> <li>Assign: link the quiz to a specific Subject and Class.</li> <li>Monitor: View real-time scores as students complete assessments.</li> </ol>"},{"location":"user-guides/school-admin/#4-inventory-store-uniformsbooks","title":"\ud83d\udce6 4. Inventory &amp; Store (Uniforms/Books)","text":"<p>Manage non-tuition items sold by the school.</p>"},{"location":"user-guides/school-admin/#setup","title":"Setup","text":"<ol> <li>Go to Store &gt; Inventory.</li> <li>Add Item: Name (e.g., \"JSS Math Text\"), Price, and Initial Stock Quantity.</li> </ol>"},{"location":"user-guides/school-admin/#recording-sales","title":"Recording Sales","text":"<p>When a parent purchases an item: 1.  Go to Store &gt; New Sale. 2.  Select the Student. 3.  Add items to cart. 4.  Checkout:     *   If paid via transfer to Virtual Account, the wallet balance is deducted.     *   Inventory count is automatically updated.</p>"},{"location":"user-guides/school-admin/#5-system-settings","title":"\ud83d\udee0 5. System Settings","text":""},{"location":"user-guides/school-admin/#session-management","title":"Session Management","text":"<ul> <li>New Term: When a term ends, go to Settings &gt; Academic Session. Select \"Start New Term\". This archives current records and prepares the system for new fees/results.</li> <li>Promote Students: At the end of a session, use the Batch Promotion tool to move students (e.g., JSS1 -&gt; JSS2).</li> </ul>"},{"location":"user-guides/school-admin/#staff-access","title":"Staff Access","text":"<ol> <li>Go to Settings &gt; Staff Management.</li> <li>Invite staff via email.</li> <li>Roles:<ul> <li>Teacher: Can only view their assigned class and enter grades.</li> <li>Bursar: Can view finance/store but cannot alter academic records.</li> <li>Admin: Full access.</li> </ul> </li> </ol>"},{"location":"user-guides/school-admin/#6-communication-hr","title":"\ud83d\udce2 6. Communication &amp; HR","text":""},{"location":"user-guides/school-admin/#broadcast-center","title":"Broadcast Center","text":"<p>Send urgent notices or routine announcements: 1.  Go to Communication &gt; Broadcast Center. 2.  Filter audience: Everyone, Parents, or Staff. 3.  Choose channel: SMS, Email, or In-Portal. 4.  Type message and Send.</p>"},{"location":"user-guides/school-admin/#staff-clock-in-hr-compliance","title":"Staff Clock-In (HR Compliance)","text":"<p>Ensure your staff is on-site: - Setup: Define your school's GPS coordinates in Settings. - Usage: Staff use the \"Mobile Clock-In\" page on their phones. The system verifies they are within the school radius and captures a facial photo with liveness check before allowing the clock-in. - Oversight: View the daily verification map and photos in Staff &gt; Attendance.</p>"},{"location":"user-guides/school-admin/#appraisals","title":"Appraisals","text":"<ol> <li>Setup termly objectives and KPIs for your staff.</li> <li>Conduct reviews at the end of the term.</li> <li>Track performance history to identify top educators.</li> </ol> <p>For technical issues, please refer to the <code>TECHNICAL_MANUAL.md</code> or contact the Platform Super Admin.</p>"},{"location":"user-guides/super-admin/","title":"Super-Admin Setup &amp; User Guide \ud83d\udc6e\u200d\u2642\ufe0f","text":"<p>This guide explains how to initialize the platform owner account and manage the SchoolPay Pro SaaS ecosystem.</p>"},{"location":"user-guides/super-admin/#step-1-initial-setup-the-god-mode-promotion","title":"\ud83d\udee0\ufe0f Step 1: Initial Setup (The \"God Mode\" Promotion)","text":"<p>For security reasons, no account can register as a Super-Admin via the UI. You must manually promote your account using the provided database script.</p>"},{"location":"user-guides/super-admin/#1-register-an-account","title":"1. Register an Account","text":"<p>Sign up normally through the application's login/signup page with your official email (e.g., <code>admin@remitpro.ng</code>).</p>"},{"location":"user-guides/super-admin/#2-configure-the-promotion-script","title":"2. Configure the Promotion Script","text":"<p>Open <code>src/db/promote_admin.ts</code> and update the <code>OWNER_EMAIL</code> variable with the email you just registered:</p> <pre><code>const OWNER_EMAIL = 'your-email@example.com'; \n</code></pre>"},{"location":"user-guides/super-admin/#3-run-the-promotion","title":"3. Run the Promotion","text":"<p>Execute the script using <code>tsx</code> (ensure your <code>.env</code> is configured with the <code>DATABASE_URL</code>):</p> <pre><code>npx tsx src/db/promote_admin.ts\n</code></pre>"},{"location":"user-guides/super-admin/#4-verify-access","title":"4. Verify Access","text":"<p>Refresh your browser. You will now see a \"Platform Admin\" section in the sidebar with a \"SaaS Platform\" link.</p>"},{"location":"user-guides/super-admin/#step-2-the-super-admin-dashboard","title":"\ud83d\udcca Step 2: The Super-Admin Dashboard","text":"<p>Located at <code>/superadmin</code>, this dashboard is your primary command center for the entire platform.</p>"},{"location":"user-guides/super-admin/#key-metrics-kpis","title":"Key Metrics (KPIs)","text":"<ul> <li>Total Onboarded Schools: Count of every individual institution using your platform.</li> <li>Total Platform Revenue: The real-time sum of the \u20a6200 platform fee collected from every successful student payment across all schools.</li> <li>Active Students Managed: Total enrollment across the entire ecosystem.</li> </ul>"},{"location":"user-guides/super-admin/#remittance-intelligence-hub","title":"Remittance Intelligence Hub","text":"<p>The dashboard now features deep financial transparency for the SaaS owner: - Projected Revenue: Based on active student accounts and termly fee cycles. - Verified Settlements: Track real-time fund splitting across the Monnify stack. - School Health Index: Monitor which schools have highest collection rates.</p>"},{"location":"user-guides/super-admin/#step-3-managing-the-200-rule","title":"\ud83d\udcb0 Step 3: Managing the \"\u20a6200 Rule\"","text":"<p>The platform is configured to automatically split payments.</p>"},{"location":"user-guides/super-admin/#how-revenue-is-collected","title":"How Revenue is Collected","text":"<ol> <li>When a Student pays, Monnify uses the <code>incomeSplitConfig</code> we provided during setup.</li> <li>The School receives theirs minus processing fees.</li> <li>Your Platform Share (\u20a6200) is logically tracked in the <code>transactions.platform_fee</code> column.</li> </ol>"},{"location":"user-guides/super-admin/#maintenance","title":"Maintenance","text":"<p>To ensure your revenue is settled correctly to your own bank account: - Ensure you have a Main Merchant Account on Monnify. - Check that the <code>PLATFORM_SUBACCOUNT_CODE</code> environment variable is set in your Supabase secrets.</p>"},{"location":"user-guides/super-admin/#step-4-troubleshooting-support","title":"\ud83d\udc6e Step 4: Troubleshooting &amp; Support","text":""},{"location":"user-guides/super-admin/#pending-subaccounts","title":"Pending Subaccounts","text":"<p>If a school shows \"PENDING\" in the Subaccount column: 1. They may have entered incorrect bank account details. 2. You can manually re-trigger onboarding or update their record in the <code>schools</code> table via Supabase Dashboard once valid details are provided.</p>"},{"location":"user-guides/super-admin/#isolation-verification","title":"Isolation Verification","text":"<p>If you ever need to verify that Multi-Tenancy (RLS) is working: 1. Log in as a School Admin. 2. Try to navigate to <code>/superadmin</code>. The application will either hide the link or the database will return 0 results because of Row Level Security.</p> <p>This guide is for internal use by Remitpro Platform Developers only.</p>"}]}